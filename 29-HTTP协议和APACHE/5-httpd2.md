# ç¬¬5èŠ‚. httpd2



# ç»§ç»­ä¸Šä¸€ç¯‡çš„é…ç½®



## ä¸»ç«™ç‚¹é¡µé¢-DocumentRoot

**å®šä¹‰'Main' serverçš„æ–‡æ¡£é¡µé¢è·¯å¾„** DocumentRoot â€œ/pathâ€

æ–‡æ¡£è·¯å¾„æ˜ å°„ï¼š

DocumentRootæŒ‡å‘çš„è·¯å¾„ä¸ºURLè·¯å¾„çš„èµ·å§‹ä½ç½® ç¤ºä¾‹ï¼š

DocumentRoot "/app/dataâ€œ

http://HOST:PORT/test/index.html --> /app/data/test/index.html æ³¨æ„ï¼šSELinuxå’Œiptablesçš„çŠ¶æ€



![image-20231007104941607](5-httpd2.assets/image-20231007104941607.png)

è¿™é‡Œä¿®æ”¹ç«™ç‚¹çš„é¡µé¢å­˜æ”¾è·¯å¾„ï¼Œè¿˜éœ€è¦ä¿è¯è¯¥è·¯å¾„çš„æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚æ³¨é‡Šæ‰ğŸ‘†ä¸Šå›¾çš„ä¸»ç«™ç‚¹é…ç½®ã€‚

![image-20231007105533835](5-httpd2.assets/image-20231007105533835.png)

ä¸‹é¢å¯¹å…¶è¿›è¡Œä¿®æ”¹ğŸ‘‡ï¼Œè¿˜æ˜¯ä½¿ç”¨å•ç‹¬çš„é…ç½®æ–‡ä»¶ï¼Œä¸å¯¹httpd.confè¿™ä¸ªä¸»æ–‡ä»¶è¿›è¡Œä¿®æ”¹

<img src="5-httpd2.assets/image-20231007105037065.png" alt="image-20231007105037065" style="zoom:50%;" /> 

![image-20231007105118589](5-httpd2.assets/image-20231007105118589.png)

æƒé™ğŸ‘†æ²¡é—®é¢˜

selinuxæ²¡é—®é¢˜ğŸ‘‡

![image-20231007105137048](5-httpd2.assets/image-20231007105137048.png)



![image-20231007105631809](5-httpd2.assets/image-20231007105631809.png)

ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œ

![image-20231007105712166](5-httpd2.assets/image-20231007105712166.png)

å¿…é¡»æ˜¯æ–‡ä»¶å¤¹ï¼Œä¸”å…¶ä¸‹æ”¾index.html

<img src="5-httpd2.assets/image-20231007105750876.png" alt="image-20231007105750876" style="zoom:33%;" /> 

é‡å¯OK



ä½†æ˜¯curl å‘ç°ä¸è¡Œ

![image-20231007105841918](5-httpd2.assets/image-20231007105841918.png)

è¿™å°±æ„å‘³ç€é¡µé¢ä¸€æ ·æ˜¯apacheçš„é»˜è®¤é¡µé¢äº†ï¼Œå› ä¸ºindex.htmlæ‰“ä¸å¼€

![image-20231007105921419](5-httpd2.assets/image-20231007105921419.png)

å¯æ˜¯å¯¹åº”çš„æ–‡ä»¶å¤¹çš„è¿›å…¥ï¼Œå’Œæ–‡ä»¶çš„å¯è¯»æƒé™éƒ½æœ‰çš„å•Šï¼Œå¥‡æ€ªäº†

ä½†æ˜¯å°±æ˜¯403 Forbiddenäº†

<img src="5-httpd2.assets/image-20231007110058968.png" alt="image-20231007110058968" style="zoom:44%;" /> 

æ‰€è°“æˆæƒä¸æ˜¯linuxç³»ç»Ÿæ–‡ä»¶çš„æˆæƒï¼Œè€Œæ˜¯httpdæœåŠ¡æœ¬èº«é…ç½®æ–‡ä»¶é‡Œè¦æ˜ç¡®æˆæƒï¼Œæ‰€ä»¥è¿˜æ˜¯é…ç½®æ–‡ä»¶é‡Œçš„é…ç½®ä¸å…¨ã€‚

<img src="5-httpd2.assets/image-20231007110435402.png" alt="image-20231007110435402" style="zoom:50%;" /> 

åŒæ ·å†™é“å•ç‹¬çš„é…ç½®æ–‡ä»¶é‡Œå»

<img src="5-httpd2.assets/image-20231007110625847.png" alt="image-20231007110625847" style="zoom:50%;" /> 

![image-20231007110654272](5-httpd2.assets/image-20231007110654272.png)

---------------è¿™æ ·å°±OKğŸ‘†äº†------------------

ç„¶åå–æ¶ˆ/dataæ–‡ä»¶å¤¹çš„æ‰€æœ‰æƒé™ï¼Œå“ˆå“ˆ

![image-20231007111300759](5-httpd2.assets/image-20231007111300759.png)

å…¶ä¸Šå›¾ä¸ç”¨é‡å¯æœåŠ¡ï¼Œå› ä¸ºä¿®æ”¹çš„osæ“ä½œç³»ç»Ÿçš„æƒé™ï¼Œè€Œä¸æ˜¯httpdæœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼ŒğŸ‘‡è¯æ˜ä¸‹ï¼š

<img src="5-httpd2.assets/image-20231007111415750.png" alt="image-20231007111415750" style="zoom:50%;" /> 

å¦‚æœæ˜¯DocumentRootä¸‹çš„å­ç›®å½•çš„indexå°±æ˜¯è¡¥ä¸€ä¸ªè·¯å¾„å°±å¥½äº†ğŸ‘‡ã€‚

![image-20231007115555925](5-httpd2.assets/image-20231007115555925.png)



#### å¦‚æœå­ç›®å½•ä¸åœ¨DocumentRootä¸‹å‘¢

1ã€<span id = 'jump1'>ç”¨è½¯è¿æ¥è¡Œä¸è¡Œï¼šğŸ‘‡å¯ä»¥çš„ï¼Œæ²¡å¾—é—®é¢˜</span>

![image-20231007115843184](5-httpd2.assets/image-20231007115843184.png)





é‚£ä¸ºä»€ä¹ˆæ–‡ä»¶é»˜è®¤å°±æ˜¯index.htmlï¼Œæ˜¯å¦å¯ä»¥ä¿®æ”¹å‘¢ï¼Ÿå¯ä»¥ï¼Œåœ¨é…ç½®é‡Œé¢æ‰¾åˆ°å…³é”®è¯DirectoryIndexğŸ‘‡

### **å®šä¹‰ç«™ç‚¹ä¸»é¡µé¢**

DirectoryIndex		index.html

![image-20231007133654437](5-httpd2.assets/image-20231007133654437.png)

å¢åŠ ä¸€ä¸ª

![image-20231007133801205](5-httpd2.assets/image-20231007133801205.png)



![image-20231007134204865](5-httpd2.assets/image-20231007134204865.png)

ä¸Šå›¾ğŸ‘†å°±è¯´æ˜äº†ï¼Œé…ç½®æ–‡ä»¶çš„å†™æ³•ï¼šDirectoryIndex m.txt index.htmlæ˜¯ä¼˜å…ˆçº§ä»å·¦åˆ°å³çš„ã€‚



å¦‚æœm.txtå’Œindex.htmlæ–‡ä»¶éƒ½ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªæŠ¥é”™çš„é¡µé¢403 Forbiddenåˆæ˜¯å“ªæ¥çš„å‘¢ï¼Ÿ

![image-20231007134656311](5-httpd2.assets/image-20231007134656311.png)

<img src="5-httpd2.assets/image-20231007134714917.png" alt="image-20231007134714917" style="zoom:50%;" />



åœ¨/etc/httpd/conf.d/ä¸‹æœ‰ä¸€ä¸ªå«welcome.confçš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­å°±æœ‰403å¯¹åº”çš„é¡µé¢ğŸ‘‡

![image-20231007134927879](5-httpd2.assets/image-20231007134927879.png)

è¿™é‡Œçš„/.noindex.htmlå°±æ˜¯ç›¸å¯¹äºDocumentRootä¸»é¡µæ ¹è·¯å¾„æ¥è®²çš„ã€‚

ä½†æ˜¯æ²¡æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œå¢å¤§ä¿ºçš„ç‹—çœ¼ä»”ç»†çœ‹çœ‹ä¸Šå›¾ æ‰¾æ‰¾çœ‹ï¼ŒAliaså•Šï¼Œ/.noindex.htmlå…¨æ–‡é‡Œå‡ºç°äº†2æ¬¡ï¼Œè¿˜ä¸æ¸…æ¥šå˜›~(/â‰§â–½â‰¦)/

åˆ æ‰è¿™ä¸ªwelcome.confæ–‡ä»¶ï¼Œè§‚å¯Ÿé¡µé¢

<img src="5-httpd2.assets/image-20231007135731812.png" alt="image-20231007135731812" style="zoom:50%;" /> 

é‡å¯æœåŠ¡åğŸ‘‡

<img src="5-httpd2.assets/image-20231007135856543.png" alt="image-20231007135856543" style="zoom:50%;" />

![image-20231007135922545](5-httpd2.assets/image-20231007135922545.png)

æ‰€ä»¥ä¿®æ”¹ä¸€ä¸‹

![image-20231007141003559](5-httpd2.assets/image-20231007141003559.png)



![image-20231007141102616](5-httpd2.assets/image-20231007141102616.png)

é¡µé¢ä¸€æ ·æ•ˆæœğŸ‘‡

<img src="5-httpd2.assets/image-20231007141112133.png" alt="image-20231007141112133" style="zoom:50%;" />



### ç«™ç‚¹è®¿é—®æ§åˆ¶å¸¸è§æœºåˆ¶

å¯åŸºäº**ä¸¤ç§æœºåˆ¶**æŒ‡æ˜å¯¹**å“ªäº›èµ„æº**è¿›è¡Œä½•ç§è®¿é—®æ§åˆ¶

â€‹		**ä¸¤ç§æœºåˆ¶**ï¼šå®¢æˆ·ç«¯æ¥æºåœ°å€ï¼Œç”¨æˆ·è´¦å·

â€‹		**å“ªäº›èµ„æº**ï¼šæ–‡ä»¶ç³»ç»Ÿè·¯å¾„ã€URLè·¯å¾„



**æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ï¼š**

â‘ é’ˆå¯¹æ–‡ä»¶å¤¹â‘¡é’ˆå¯¹æ–‡ä»¶â‘¢å†™æ­£åˆ™åŒ¹é…

```
<Directory	â€œ/path">
...
</Directory>
<File	â€œ/path/fileâ€>
...
</File>
<FileMatch	"PATTERN">
...
</FileMatch>

```

**URLè·¯å¾„ï¼š**

```
<Location	"">
...
</Location>
<LocationMatch "">
...
</LocationMatch>

```

**ç¤ºä¾‹ï¼š**

```
<FilesMatch "\.(gif|jpe?g|png)$">       	# FilesMatchå°±æ˜¯REGEXæ­£åˆ™
<Files â€œ?at.*â€>	é€šé…ç¬¦       			  	  # åº”è¯¥æ˜¯Files å¼€å¤´å°±æ˜¯é€šé…ç¬¦
<Location /status>                			# Locationå°±æ˜¯URL
<LocationMatch "/(extra|special)/data">     # LocationMatchå°±æ˜¯urlé‡Œçš„regexæ­£åˆ™
```



**å…·ä½“çš„å†™æ³•-å¸¦ä¸Šæº**



```
<Directory>ä¸­â€œåŸºäºæºåœ°å€â€å®ç°è®¿é—®æ§åˆ¶

(1) Optionsï¼šåè·Ÿ1ä¸ªæˆ–å¤šä¸ªä»¥ç©ºç™½å­—ç¬¦åˆ†éš”çš„é€‰é¡¹åˆ—è¡¨
	åœ¨é€‰é¡¹å‰çš„+ï¼Œ- è¡¨ç¤ºå¢åŠ æˆ–åˆ é™¤æŒ‡å®šé€‰é¡¹

å¸¸è§é€‰é¡¹ï¼š
Indexesï¼šæŒ‡æ˜çš„URLè·¯å¾„ä¸‹ä¸å­˜åœ¨ä¸å®šä¹‰çš„ä¸»é¡µé¢èµ„æºç›¸ç¬¦çš„èµ„æºæ–‡ä»¶æ—¶ï¼Œè¿”å›ç´¢å¼•åˆ—è¡¨ç»™ç”¨æˆ·
FollowSymLinksï¼šå…è®¸è®¿é—®ç¬¦å·é“¾æ¥æ–‡ä»¶æ‰€æŒ‡å‘çš„æºæ–‡ä»¶ 
Noneï¼šå…¨éƒ¨ç¦ç”¨
Allï¼š	å…¨éƒ¨å…è®¸


ç¤ºä¾‹ï¼š
<Directory /web/docs>
	Options Indexes FollowSymLinks
</Directory>
<Directory /web/docs/spec>
	Options FollowSymLinks
</Directory>


```

### Indexesï¼šæŒ‡æ˜çš„URLè·¯å¾„ä¸‹ä¸å­˜åœ¨ä¸å®šä¹‰çš„ä¸»é¡µé¢èµ„æºç›¸ç¬¦çš„èµ„ æºæ–‡ä»¶æ—¶ï¼Œè¿”å›ç´¢å¼•åˆ—è¡¨ç»™ç”¨æˆ·

**å°±æ˜¯è®¿é—®é¡µé¢ä¸å­˜åœ¨ï¼Œè¿”å›å½“å‰è·¯å¾„ä¸‹çš„åˆ—è¡¨ï¼Œé¡µé¢æ˜¾ç¤ºå‡ºæ¥çš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶éƒ½å¯ä»¥ç‚¹å‡»ï¼Œç±»ä¼¼yumæºç½‘ç«™çš„ç‚¹å‡»æµè§ˆä¸€æ ·**

![image-20231007143821355](5-httpd2.assets/image-20231007143821355.png)

ç„¶åé¡µé¢è®¿é—®æ˜¯é»˜è®¤çš„æŠ¥é”™é¡µé¢

![image-20231007144403825](5-httpd2.assets/image-20231007144403825.png)

åˆ æ‰è¯¥æ–‡ä»¶ä¹Ÿæ²¡ç”¨ï¼

æ‰¾æ‰¾å®˜ç½‘è¯´æ˜

![image-20231007153451751](5-httpd2.assets/image-20231007153451751.png)

è¿™ä¸ªæ¨¡å—ä¹ŸåŠ è½½äº†å•Š

![image-20231007153507904](5-httpd2.assets/image-20231007153507904.png)

æä¸æ‡‚ï¼Œç»§ç»­æŠ˜è…¾ï¼Œå‘ç°è¿˜æ˜¯welcome.confæçš„é¬¼ï¼Œè¿™æ ·å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œå…¶å®å°±æ˜¯ğŸ‘‡è¿™é‡Œå¾—options -Indexesã€‚  - å‡å·å°±æ˜¯ç¦æ­¢å•Šï¼Œç¦ç”¨äº†ç›®å½•ç´¢å¼•åŠŸèƒ½ã€‚

![image-20231007162756638](5-httpd2.assets/image-20231007162756638.png)



ç„¶ådir1ä¸ç°å®ï¼Œdir2å¯ä»¥çš„ï¼Œç ”ç©¶ä¸‹dir1ä¸ºå•¥ä¸æ˜¾ç¤º

![image-20231007155411441](5-httpd2.assets/image-20231007155411441.png)

æä¸æ‡‚dir1ä¸ºå•¥ä¸æ˜¾ç¤ºäº†ï¼Œ[ä¹‹å‰å¯ä»¥çš„å•Š](#jump1)

![image-20231007155538433](5-httpd2.assets/image-20231007155538433.png)



![image-20231007161148352](5-httpd2.assets/image-20231007161148352.png)

å°±æ˜¯dir1å¥½å¥½çš„ä¸è¡Œäº†ï¼Œå“ˆå“ˆ

![image-20231007161141031](5-httpd2.assets/image-20231007161141031.png)



![image-20231007161656178](5-httpd2.assets/image-20231007161656178.png)



ğŸ‘‡ç»“æœå‘ç°æ˜¯è½¯è¿æ¥å¾—é—®é¢˜ï¼Œä½†æ˜¯ä¹‹å‰å¯ä»¥å¾—å•Šï¼

![image-20231007163745035](5-httpd2.assets/image-20231007163745035.png)



![image-20231007164158405](5-httpd2.assets/image-20231007164158405.png)

æƒé™OKğŸ‘†ï¼Œæ‰¾åˆ°å…ƒå©´äº†ï¼ŒğŸ‘‡**å°±æ˜¯å¼€å¯indexeså°±ä¸æ”¯æŒè½¯è¿æ¥äº†ï¼Œå¥‡æ€ªäº†ï¼Œå…ˆè®°ç€è¿™ä¸ªç‚¹**

![image-20231007175831767](5-httpd2.assets/image-20231007175831767.png)

ğŸ‘†åŒæ—¶æ³¨æ„ï¼šcurl ä¸åŒäºæµè§ˆå™¨http://192.168.126.130/dir2 ,  æµè§ˆå™¨è¿™æ ·å›è½¦è‡ªåŠ¨å°±æ˜¯dir2/ è¡¥ä¸€ä¸ªæ–œæ çš„/ï¼›  curl æ²¡æ–œæ†/æœ‰é—®é¢˜çš„ã€‚



æ¥ä¸€å¼ æ€»ç»“å›¾ğŸ‘‡ï¼Œç»“è®ºå°±æ˜¯ **options indexesä¼šå¯¼è‡´ln -s çš„403 Forbiddenã€‚**

![image-20231007180604795](5-httpd2.assets/image-20231007180604795.png)





å¦‚æœè¦æŠŠè½¯è¿æ¥ä¹Ÿæ˜¾ç¤ºå‡ºæ¥ï¼Œéœ€è¦å†é…ç½®ä¸€ä¸‹

### FollowSymLinksï¼šå…è®¸è®¿é—®ç¬¦å·é“¾æ¥æ–‡ä»¶æ‰€æŒ‡å‘çš„æºæ–‡ä»¶

å½“ç„¶ï¼Œwelcome.confé‡Œçš„-Indexesè¦å»æ‰çš„

![image-20231007181947268](5-httpd2.assets/image-20231007181947268.png)



![image-20231007182031235](5-httpd2.assets/image-20231007182031235.png)

![image-20231007182500958](5-httpd2.assets/image-20231007182500958.png)



è¡¥ä¸Šå¯¹åº”å‚æ•°åå°±å¯ä»¥æ˜¾ç¤ºè½¯è¿æ¥äº†ğŸ‘‡

![image-20231007182638822](5-httpd2.assets/image-20231007182638822.png)

<img src="5-httpd2.assets/image-20231007182931735.png" alt="image-20231007182931735" style="zoom:33%;" />





