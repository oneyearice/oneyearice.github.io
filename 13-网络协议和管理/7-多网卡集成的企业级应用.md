# ç¬¬7èŠ‚. å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨



æ•°æ®ä¼ è¾“ä¸€æ¡é¾™ï¼Œä»ç½‘å£è¿›æ¥ï¼Œåˆ°å†…å­˜ã€åˆ°ç¡¬ç›˜ï¼Œä¸­é—´è¿˜æœ‰CPUçš„è¿ç®—ã€‚

æ‰€ä»¥çœ‹çœ‹å“ªé‡Œæ˜¯ç“¶é¢ˆï¼Œiperfå°±æ˜¯å†…å­˜åˆ°å†…å­˜çš„æµ‹è¯•æ–¹æ³•ï¼ŒSFTPå°±æ˜¯åˆ°ç¡¬ç›˜çš„æµ‹è¯•æ‰‹æ®µã€‚



## å¤šç½‘å¡ç»‘å®šçš„æ¨¡å¼

![image-20220321191927372](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220321191927372.png) 



![image-20220321191938141](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220321191938141.png)

ğŸ‘†Mode1å…¶å®é€šè¿‡ä¸Šè¿°ï¼Œå°±çŸ¥é“SWé‚£å¤´å¦‚æœå‘ç°åªæœ‰ä¸€ä¸ªå¤–éƒ¨ç«¯å£èƒ½çœ‹åˆ°MACåœ°å€ï¼Œå°±è¯´æ˜æ˜¯Mode1äº†ã€‚

0 2 3 4 éƒ½éœ€è¦SWé‚£å¤´é…ç½®portchannelï¼Œ4è¿˜éœ€è¦åŠ¨æ€çš„åè®®ã€‚



## Bondingé…ç½®

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322091516461.png" alt="image-20220322091516461" style="zoom:67%;" /> 

1ã€miimonï¼Œæ¯”å¦‚mode1ä¸‹ï¼Œå°±æ˜¯slaveç›‘æ§masterçš„å‘¨æœŸé—´éš”100msï¼›

2ã€æ–°å»ºifcfg-bond0ï¼›

3ã€ä¿®æ”¹ä¸¤ä¸ªç½‘å¡é…ç½®æ–‡ä»¶ã€‚

## å®éªŒ

VMè™šæœºéƒ½æ”¹åˆ°ä¸€ä¸ªç½‘ç»œé‡Œ

![image-20220322092046415](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322092046415.png)

åšbondä¹‹å‰ç¦ç”¨NetworkManageræœåŠ¡ï¼Œå¹¶å¼€æœºç¦ç”¨ã€‚

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322092251075.png" alt="image-20220322092251075" style="zoom:67%;" /> 

åˆ é™¤å¤šä½™çš„æ–‡ä»¶ï¼Œä¿è¯bondæˆå‘˜å£çš„é…ç½®å¹²å‡€

![image-20220322092314785](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322092314785.png)

### åˆ›å»ºifcfg-bond0

![image-20220322092404984](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322092404984.png)

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322092608266.png" alt="image-20220322092608266" style="zoom:80%;" /> 

è¿™ä¸ªè®¾å¤‡å½“å‰æ˜¯æ²¡æœ‰çš„ip açœ‹ä¸åˆ°ï¼Œå¾…ä¼šé…ç½®å®Œæ¯•åï¼Œé‡å¯æœåŠ¡å™¨åå°±æœ‰äº†

### é…ç½®ç‰©ç†æ¥å£åŠ å…¥bond0é‡Œ

#### ç¼–è¾‘eth0ç½‘å¡

![image-20220322092722089](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322092722089.png)

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322092926176.png" alt="image-20220322092926176" style="zoom:80%;" /> 

 MASTER=bond0 ä»¥åŠSLAVE=yesï¼Œè¿™æ ·ï¼Œè¿™ä¸ªç½‘å¡å°±å±äºbond0äº†ï¼Œåœ°å€å°±æ˜¯bond0è¯´äº†ç®—ï¼Œä¸‹é¢çš„åœ°å€å°±æ— æ•ˆäº†ã€‚

#### å†ä¿®æ”¹eth1ç½‘å¡é…ç½®

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322093303509.png" alt="image-20220322093303509" style="zoom:80%;" /> 

#### ç„¶åé‡å¯ç½‘ç»œæœåŠ¡å°±OKäº†

![image-20220322093443513](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322093443513.png)



![image-20220322093410459](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322093410459.png) 



æ³¨æ„ï¼Œbond0èµ·æ¥åï¼Œè¿æ¥çš„ä¸¤ä¸ªç‰©ç†æˆå‘˜å£çš„IPå°±å¤±æ•ˆäº†ï¼Œä¹‹å‰sshå°±æ–­å¼€äº†ï¼Œåªèƒ½é€šè¿‡æœ¬åœ°ç»ˆç«¯ç™»å…¥ä¸Šå»çœ‹çœ‹äº†ã€‚

#### æ£€æŸ¥ä¸‹

![image-20220322093625909](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322093625909.png) 

eth0å’Œeth1å·²ç»ä¸å¯¹å¤–äº†ï¼Œè€Œä¸”MACåœ°å€æ˜¯æˆå‘˜å£å’Œbondå£å…¬ç”¨çš„ã€‚

å› ä¸ºåšçš„æ˜¯bond0ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªä¸»çš„ï¼Œé€šè¿‡æŸ¥çœ‹procç¡®è®¤è°æ˜¯Aè°æ˜¯S

![image-20220322094001620](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322094001620.png) 

å¯è§å½“å‰æ˜¯active-backupæ¨¡å¼ä¹Ÿå°±æ˜¯mode1ï¼Œeth0æ˜¯ä¸»

å°†eth0æ–­å¼€(å‰é¢ä¸€ä¸ªå°±æ˜¯eth0)ï¼Œæµ‹è¯•ä¸‹è¿é€šæ€§

![image-20220322094128951](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322094128951.png) 

å‘ç°ä¸¢äº†ä¸€ä¸ªåŒ…

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322094350545.png" alt="image-20220322094350545" style="zoom:67%;" /> 

ä¸¤æ ¹çº¿éƒ½downçš„æ ·å­

cat /proc/net/bonding/bond0 ï¼Œä¸‹é¢centos7ä¸€æ ·çš„å‘½ä»¤

![image-20220322094707678](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322094707678.png) 

ä¸»å¤‡åˆ‡æ¢ï¼Œä¸ä¼šæŠ¢å ã€‚



æ”¹æˆmode3 broadcastçœ‹ä¸‹

![image-20220322095014657](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322095014657.png) 

![image-20220322095058644](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322095058644.png) 

![image-20220322095114000](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322095114000.png) 

![image-20220322095122129](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322095122129.png)

37.100å°±æ˜¯bond0çš„IPäº†ï¼Œè¿™ä¸ªDUPå°±è¯´æ˜broadcastæ˜¯æˆå‘˜éƒ½å·¥ä½œçš„ã€‚

åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œæ–­å¼€ä¸€ä¸ªæ¥å£ï¼Œå‘ç°ä¸é€šäº†(åœ¨è™šæ‹Ÿæœºç¯å¢ƒä¸‹)ï¼Œå› ä¸ºè¦ç»“åˆSWé…ç½®ã€‚

![image-20220322095810379](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322095810379.png) 

![image-20220322111543256](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322111543256.png) 



## centos7çš„é…ç½®æ–¹æ³•

centos7æœ€å¤§åŒºåˆ«å°±æ˜¯ç½‘å¡åç§°ä¸ä¸€æ ·ï¼Œ7é€šå¸¸éƒ½æ˜¯ensxxxï¼Œä¸€èˆ¬æ˜¯cents7æ˜¯æ ¹æ®ç½‘å¡æ’æ§½å®šä¹‰çš„ï¼Œä¸ºäº†ç¨³å®šï¼Œä¸è¿‡ä¸€èˆ¬ç½‘å¡ä¹Ÿä¸ä¼šå¢åŠ åˆ é™¤ï¼Œæ‰€ä»¥æ›´å¤šè¿˜æ˜¯è®¤ä¸ºæ”¹æˆeth0 eth1 è¿™ç§æ–¹å¼ã€‚

![image-20220322111651787](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322111651787.png)



## cents7æ”¹ç½‘å¡åç§°



<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322111918326.png" alt="image-20220322111918326" style="zoom:67%;" /> 

é˜”ä»¥çš„ï¼Œè™½ç„¶ä¸‹é¢çš„å’Œrocky-linuxä¸åŒï¼Œä½†æ˜¯rocky-linxæµ‹è¯•ä¸€æ ·çš„æ“ä½œï¼Œå°±æ˜¯ç”Ÿæˆçš„æ–‡ä»¶é‡Œçš„ifnames=0çš„ä½ç½®ä¸åŒç½¢äº†ã€‚

ä¿®æ”¹/etc/default/grub

![image-20220322101757001](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322101757001.png) 

![image-20220322101823159](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322101823159.png) 



ubuntué‡Œä¹Ÿæ˜¯ens33ï¼Œ

åˆ‡æ¢æˆrootèº«ä»½ï¼š

![image-20220322102121999](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322102121999.png) 

![image-20220322102234212](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322102234212.png) 

ä¸Šé¢æ”¹å®Œè¿˜ä¸å¤Ÿï¼Œéœ€è¦åˆ©ç”¨å·¥å…·è¦†ç›–ä¸€ä¸ªæ–‡ä»¶

```
ubuntuéœ€è¦grub-mkconfig -o /boot/grub/grub.cfg;reboot
centos7éœ€è¦grub2-mkconfig -o /boot/grub2/grub.cfg;reboot
```

![image-20220322110009067](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322110009067.png) 

![image-20220322110050718](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322110050718.png) 

rebootå³å¯

![image-20220322115311157](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322115311157.png)





![image-20220322102820719](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322102820719.png) 

ä¸æ¨èä¿®æ”¹ï¼Œéœ€è¦å€ŸåŠ©grub-mkconfigæ¥ç”Ÿæˆè¿™ä¸ª/boot/grub2/grub.cfgæ–‡ä»¶ã€‚

![image-20220322102919571](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322102919571.png)

grub2-mkconfig -o /boot/grub2/grub.cfg   é»˜è®¤å°±ä¼šè¯»å–/etc/default/grubæ–‡ä»¶æ¥ç”Ÿæˆæœ€ç»ˆæ–‡ä»¶ã€‚ç„¶årebootç”Ÿæ•ˆã€‚



æ€»ä¹‹centos7ä¸Šç½‘å¡åç§°æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322113931899.png" alt="image-20220322113931899" style="zoom:80%;" /> 

wlxxxå°±æ˜¯wifiç½‘å¡ï¼Œ



å…¶å®centos7çš„ç½‘å¡å‘½åçš„å‰å› åæœæ˜¯è¿™æ ·çš„

https://developer.aliyun.com/article/609587

rocky-linuxä¿®æ”¹å¤§åŒå°å¼‚

https://blog.51cto.com/feko/2751292



![image-20220322114956198](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322114956198.png) 

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322115005824.png" alt="image-20220322115005824" style="zoom:70%;" /> 





## centos7ä¿®æ”¹ä¸»æœºå



![image-20220322115708996](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322115708996.png) 

![image-20220322115720020](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322115720020.png)

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322115745632.png" alt="image-20220322115745632" style="zoom:80%;" /> 

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322115652439.png" alt="image-20220322115652439" style="zoom:80%;" /> 





## nmcli

nmcli  åŠæ—¶NetworkManger cliçš„æ„æ€ï¼Œé…åˆNetworkManageræœåŠ¡ç”¨çš„

é€šè¿‡tabé”®å¯è§æœ‰å“ªäº›å­å‘½ä»¤ï¼Œä¸»è¦ç”¨åˆ°çš„æ˜¯connection å’Œ device

![image-20220322142837223](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322142837223.png)



deviceæ˜¯æ•°æ®é“¾è·¯å±‚

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322143007263.png" alt="image-20220322143007263" style="zoom:80%;" /> 

å¦‚æœç½‘çº¿æ–­æ‰ä¸€æ ¹ï¼Œå°±ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾æƒ…å†µï¼š

![image-20220322143210942](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322143210942.png) 

çœ‹æ¥å£è¯¦æƒ…

![image-20220322143433110](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322143433110.png)

ä»¥åŠ

![image-20220322143448678](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322143448678.png)



ä½¿ç”¨connectionæŸ¥çœ‹ç½‘ç»œå±‚

![image-20220322143610243](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322143610243.png)

è¿™é‡Œçš„NAMEå’ŒDEVICEå¯ä»¥ä¸åŒï¼Œå¦‚ä¸‹

![image-20220322143830996](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322143830996.png) 

ç„¶åsystemctl restart NetworkManagerå¯å¾—ï¼š

![image-20220322143737437](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322143737437.png)



nmcliçš„ä½¿ç”¨åœºæ™¯å’Œä¹ æƒ¯ï¼Œå‘½ä»¤è¡Œå˜›é¦–å…ˆæ˜¯ï¼Œçµæ´»

nmcli connection add con-name eth1-test ifname eth0 type ethernet ipv4.method manual ipv4.addresses 1.1.1.1/24

![image-20220322144607426](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322144607426.png)

ç›®å‰é’ˆå¯¹eth1æœ‰ä¸¤å¥—é…ç½®ï¼Œç”Ÿæ•ˆäº†ä¸€å¥—

![image-20220322144955677](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322144955677.png) 

![image-20220322145051221](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322145051221.png)

![image-20220322145232881](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322145232881.png)

é€šè¿‡ä¸Šå›¾è¿‡ç¨‹æˆªå›¾å¯çŸ¥ï¼Œnmcli connection add con-name eth1-test ifname eth0 type ethernet ipv4.method manual ipv4.addresses 1.1.1.1/24

ä¼šç”Ÿæˆifcfg-eth1-testç½‘å¡é…ç½®æ–‡ä»¶ï¼›ä½†æ˜¯å¦‚æœæ˜¯äººå·¥åˆ›å»ºä¸€ä»½æ–°çš„ç½‘å¡æ–‡ä»¶nmclié»˜è®¤æ˜¯ä¸ä¼šè¯†åˆ«ç”Ÿæ•ˆçš„ï¼Œéœ€è¦nmcli connection reloadä¸€ä¸‹

![image-20220322145707961](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322145707961.png)

![image-20220322145830642](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322145830642.png)

ç½‘å¡çš„UUDIå¿…é¡»å”¯ä¸€ï¼Œç®€å•å¤„ç†æ–¹æ³•å°±æ˜¯åˆ æ‰æ”¹è¡Œå°±è¡Œã€‚

![image-20220322145645431](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322145645431.png) 

æ­¤æ—¶eth1-test2å°±åŠ è½½äº†ï¼Œè¦æ˜¯ç”Ÿæ•ˆåŒæ ·nmcli connection up eth1-test2

![image-20220322150028848](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322150028848.png)



nmcliåˆ é™¤è¿æ¥

åˆ é™¤åœ¨ç”¨çš„è¿æ¥(ä¹Ÿå°±æ˜¯ç½‘å¡é…ç½®)ï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€ä¸ªã€‚

![image-20220322150308698](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322150308698.png)

nmcli connection delete eth1-test2å/etc/sysconfig/network-scrips/ä¸‹çš„ifcfg-eth1-test2ç½‘å¡é…ç½®æ–‡ä»¶å°±æ²¡äº†ã€‚



æ‰‹åŠ¨åˆ é™¤ç½‘å¡é…ç½®æ–‡ä»¶ï¼Œnmcliä¸ä¼šè‡ªåŠ¨åˆ‡ï¼Œè¿˜éœ€è¦reload

![image-20220322150835903](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322150835903.png)

![image-20220322150900492](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322150900492.png) 



æ‰€ä»¥æ€»ç»“æ¥äº†

1ã€nmcliå°±æ˜¯å‘½ä»¤è¡Œæ¥ç›´æ¥é…ç½®ç½‘å¡é…ç½®æ–‡ä»¶çš„ï¼Œnmcliåˆ é™¤åˆ›å»ºçš„è¿æ¥ï¼Œå°±æ˜¯ç½‘å¡çš„é…ç½®æ–‡ä»¶ã€‚

2ã€å¦‚æœä¸æ˜¯ä½¿ç”¨nmcliåˆ›å»º\åˆ é™¤connection(å…¶å®å°±æ˜¯é…ç½®æ–‡ä»¶)ï¼Œè€Œæ˜¯æ‰‹åŠ¨åˆ›å»º\åˆ é™¤çš„ifcfg-xxxé…ç½®æ–‡ä»¶ï¼Œå°±éœ€è¦nmcli connection reloadåŠ è½½ä¸€ä¸‹



nmcliå¼ºå¤§åœ¨æ˜¾ç¤ºä¿¡æ¯

![image-20220322151406747](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322151406747.png)



nmcliä¿®æ”¹æ¥å£ä½DHCP

![image-20220322151505664](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322151505664.png)

è¿™æ ·é…ç½®æ–‡ä»¶é‡Œçš„DHCPå°±ä¿®æ”¹å¥½äº†

![image-20220322151551993](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322151551993.png)

é€šè¿‡nmcli connection show eth1-testå¯è§

![image-20220322151657686](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322151657686.png)

è¿™é‡Œçš„autoå°±æ˜¯dhcp

ç„¶ååœ¨å¯ç”¨è¯¥é…ç½®

![image-20220322151800580](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322151800580.png)

![image-20220322151842427](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322151842427.png)

![image-20220322151908657](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322151908657.png)

è¿™ä¸ªçœ‹DHCPOPTIONè¿˜æ˜¯ä¸é”™çš„ï¼Œä»€ä¹ˆ43ã€150éƒ½èƒ½è§ç€äº†ã€‚

ä¸è¿‡ä¹Ÿä¸æ˜¯å°±è¿™ä¸€ç§æ–¹æ³•çœ‹DHCPçš„ä¿¡æ¯ï¼Œè¿˜æœ‰

![image-20220322152304079](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322152304079.png)

è™½ç„¶ä¸Šå›¾æ˜¯æ‰‹åŠ¨éŸ©å›½çš„25.44ï¼Œä½†æ˜¯ä¹‹å‰çš„dhcpè·å–çš„ä¿¡æ¯è¿˜åœ¨ã€‚

æœ‰ä¸ªä¸œè¥¿æ¯”è¾ƒå‘µå‘µâ‘ æ–°çš„æ—§çš„å‘½ä»¤æŠ€æœ¯ä½ éƒ½ä¼šâ‘¡è€å·¥ç¨‹å¸ˆæ–°å·¥ç¨‹å¸ˆåœ¨ä½ é¢å‰å°±æ²¡æœ‰ä¼˜åŠ¿å¯è¨€â‘¢è¿™ä¸ªæ—¶å€™äººé™…å…³ç³»å°±æ¯”è¾ƒå’Œè°äº†



nmcli å¢åŠ IPåœ°å€

![image-20220322152952133](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322152952133.png)

![image-20220322153038210](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322153038210.png)

è¿™ä¸ªnmcli connection modify eth1-test +ipv4.addresses 3.3.3.3/24å…¶å®å°±æ˜¯ä¿®æ”¹äº†é…ç½®æ–‡ä»¶

![image-20220322153213431](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322153213431.png)

å†åŠ ä¸€ä¸ªåœ°å€

![image-20220322153242652](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322153242652.png)

è¿™åŠ çš„second ipï¼Œip aå¯ä»¥çœ‹ifconfig çœ‹ä¸äº†ï¼Œè¿™ä¸ªåœ¨ä¸Šä¸€èŠ‚é‡ç‚¹è®²è¿‡äº†ã€‚



å…¶ä»–è¡¥å……

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322160446783.png" alt="image-20220322160446783" style="zoom: 67%;" /> 

æ³¨æ„å“¦åŠ è½½(reload)æ˜¯æŒ‡é…ç½®æ–‡ä»¶çš„é‡æ–°åŒæ­¥ä¸‹ï¼šæ¯”å¦‚äººå·¥ä¿®æ”¹åˆ›å»ºçš„ï¼ŒåŒæ­¥åˆ°nmcliè¿™é‡Œ

![image-20220322172545898](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322172545898.png)

è¿™æ˜¯ä¸éœ€è¦reloadçš„å“¦ã€‚





nmcliå®ç°bonding

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322163046810.png" alt="image-20220322163046810" style="zoom: 67%;" /> 

å®éªŒ

1ã€å°†ä¸¤ä¸ªç½‘å¡éƒ½æ¥åˆ°ä¸€ä¸ªSWä¸Šï¼ŒWMworkstationå°±æ˜¯æ¥å…¥ä¸€ä¸ªç½‘ç»œé‡Œ

æ¸…é™¤ä¹‹å‰çš„ç½‘å¡é…ç½®

![image-20220322163317401](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322163317401.png)



å¼€å§‹é…ç½®

typeå¾ˆå¤šå•Šï¼Œå¥½å‹adslã€wifiã€vxlan

![image-20220322165636687](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322165636687.png)

nmcli connection add con-name mybond0 type bond ifname bond0 mode active-backup ipv4.method manul ipv4.address 192.168.37.100/24

![image-20220322165910656](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322165910656.png)

![image-20220322170046467](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322170046467.png)

ä½†æ˜¯å·²ç»å‘ç°è¿œç«¯å¯ä»¥pingé€šè¿™ä¸ªé¢bond0çš„IPåœ°å€äº†

![image-20220322170314171](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322170314171.png) 

å…¶å®åŸå› æ˜¯scope globalå±æ€§å¯¼è‡´çš„ï¼Œåªè¦è¿™ä¸ªè®¾å¤‡ä¸Šçš„æ¥å£å¸¦globalå±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥èƒŒå‘/æœå‘éƒ½èƒ½pingé€šçš„ã€‚

![image-20220322170623939](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322170623939.png)

å·¥ä½œåœ¨å†…æ ¸çº§åˆ«ï¼Œåªè¦æµé‡èƒ½å‘åˆ°è¿™ä¸ªè®¾å¤‡ä¸Šï¼Œæ¯”å¦‚ping 192.168.37.100çš„ICMPåˆ°äº†è¿™ä¸ªè®¾å¤‡ä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥å“åº”çš„ã€‚

è¿™ä¸ªpingé€šä¸ä»£è¡¨bondingç»‘å®šæˆåŠŸï¼Œè€Œæ˜¯è™šæ‹Ÿçš„ä¸€ä¸ªç½‘å¡é€šäº†ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥ç»‘ä¸Šç‰©ç†æˆå‘˜æ¥å£çš„ã€‚

![image-20220322171539610](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322171539610.png)

ä¸Šå›¾type åä¸¤ä¸ªtabé‡Œæ²¡æœ‰bond-slaveè‡ªåŠ¨è¡¥é½ï¼Œæˆ‘çš„å¯èƒ½ç‰ˆæœ¬è¾ƒé«˜æœ‰çš„

![image-20220322171701141](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322171701141.png)

![image-20220322171930531](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322171930531.png)

æ­¤æ—¶å°±å‡ºæ¥äº†ï¼Œä½†æ˜¯æ²¡æœ‰èµ·ä½œç”¨ï¼Œä¹Ÿå…ˆä¸æ‰æ€¥å¯ç”¨

![image-20220322171957483](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322171957483.png)

![image-20220322172201955](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322172201955.png)

è„¸åšï¼Œä½ æ²¡çœ‹é”™è„¸åšæˆ‘ä»¬å°±æ¿€æ´»ä¸€ä¸‹

![image-20220322172722616](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322172722616.png)

ç”±äºç°åœ¨åªåŠ äº†ä¸€ä¸ªeth1ï¼Œæ‰€ä»¥

![image-20220322172802034](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322172802034.png)

ç„¶åå†æŠŠå¦ä¸€ä¸ªæ¥å£åŠ è¿›æ¥ï¼Œ

![image-20220322173040388](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322173040388.png)

è¿™ä¸ªï¼Œå¦‚å›¾å°±æ–­äº†ï¼Œå› ä¸ºsshçš„è¿™ä¸ªæœºå™¨çš„è¿™ä¸ªç½‘å¡ï¼Œç°åœ¨åŠ è¿›äº†bond0é‡Œäº†ï¼Œæ‰€ä»¥è‡ªç„¶å°±æ–­äº†ã€‚è¿™ä¹Ÿæ˜¯å®æ“bond0çš„æ—¶å€™è¦çŸ¥é“çš„ï¼Œæ²¡äº‹ï¼Œä¿è¯bond0èµ·æ¥å°±èƒ½sshé‚£ä¸ªåœ°å€å°±è¡Œäº†ã€‚

å»ç»ˆç«¯çœ‹ä¸‹ï¼Œå·²ok

![image-20220322173242079](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322173242079.png)

åŒæ ·çœ‹ä¸‹ /proc/net/bonding/bond0

![image-20220322173410486](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322173410486.png)

ç„¶åæµ‹è¯•ä¸€ä¸‹æ–­å¼€çš„æ•ˆæœï¼Œeth1æ˜¯åé¢ä¸€å—ç½‘å¡

![image-20220322173535739](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322173535739.png)

å‘ç°ä¸¢äº†1ä¸ªåŒ…å“¦icmp_seq=309è¿™ä¸ªã€‚

![image-20220322173604922](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322173604922.png)

æ­¤æ—¶eth1å°±downï¼Œeth0å°±activeäº†

<img src="7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322173750191.png" alt="image-20220322173750191" style="zoom:90%;" /> 



![image-20220322181828932](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322181828932.png)

åˆ æ‰mybond0è¿™ä¸ªè¿æ¥ï¼Œä¸¤ä¸ªæˆå‘˜çš„è¿æ¥å°±ä¸‹æ¥äº†ã€‚



![image-20220322181917671](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322181917671.png)



## ç½‘ç»œç»„

centos7æ¯”centos6å¤šäº†ä¸€ä¸ªç½‘ç»œç»„ æ–°æŠ€æœ¯

![image-20220322182040775](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322182040775.png)

network teamingå’Œbondingä¸€æ ·ï¼Œæ€§èƒ½æ®è¯´æ›´å¥½ï¼Œåº•å±‚æŠ€æœ¯å®ç°ä¸åŒã€‚



![image-20220322183318622](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322183318622.png)



**åˆ›å»ºç½‘ç»œç»„æ¥å£**

![image-20220322182954058](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322182954058.png)





**åˆ›å»ºportæ¥å£**

![image-20220322183308274](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322183308274.png)



**ç¤ºä¾‹**

![image-20220322183339555](7-å¤šç½‘å¡é›†æˆçš„ä¼ä¸šçº§åº”ç”¨.assets/image-20220322183339555.png)

å…·ä½“å‘½ä»¤å’Œbondingä¸€æ ·ï¼Œæ•ˆæœä¸€æ ·ï¼Œå°±æ˜¯å…³é”®å­—æ”¹äº†ï¼ŒæŠ€æœ¯æ›´ä¼˜ã€‚



æ‰€ä»¥centos7å»ºè®®ç”¨teamè€Œä¸æ˜¯bondï¼Œ6å˜›åªèƒ½bondäº†å§ã€‚

