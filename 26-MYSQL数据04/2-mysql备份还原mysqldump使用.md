# ç¬¬2èŠ‚. mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨



# mysqldump

mysqldumpæ˜¯mariadb-clientå®‰è£…çš„æ—¶å€™å°±è‡ªå¸¦çš„

![image-20230719150441673](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719150441673.png)

æŸ¥çœ‹mysqldumpçš„å¸®åŠ©ä¿¡æ¯ï¼š

![image-20230719150957100](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719150957100.png)

![image-20230719151016824](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719151016824.png)

![image-20230719151121884](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719151121884.png)

-A ä¹Ÿä¸æ˜¯çœŸçš„å¦‚ä¸Šå›¾æ‰€è¯´æ˜¯all-databasesï¼Œä¸ä¼šå¤‡ä»½information_schemaï¼Œä¹Ÿä¸ä¼šå¤‡ä»½performance_schemaï¼Œ

<img src="2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719151440765.png" alt="image-20230719151440765" style="zoom:50%;" />



æ¯”å¦‚å¯ä»¥è¿™ä¹ˆå†™

mysqldump hellodb   		# å¿…é¡»æŒ‡å®šä¸€ä¸ªæ•°æ®åº“

mysqldump hellodb students

mysqldump hellodb



mysqldump -uroot -pxxx mysql å¯¹ mysqlè¿™ä¸ªç³»ç»Ÿåº“è¿›è¡Œå¤‡ä»½ğŸ‘‡

![image-20230719155506000](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719155506000.png)

1ã€mysqldump db_name æ˜¯æŠŠæ•°æ®åº“é‡Œçš„ä¸œè¥¿åšäº†ä¸ªä¸€ä¸ªæ˜¾ç¤ºï¼Œå¯ä»¥çœ‹åˆ°userçš„è§†å›¾ï¼Œslowlogçš„insertç­‰ç­‰

![image-20230719170313496](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719170313496.png)

![image-20230719170345245](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719170345245.png)



![image-20230719171635867](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719171635867.png)

çœ‹æç¤ºï¼Œå…³é—­binlog

![image-20230719172734478](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719172734478.png)



è¿™æ ·å°±å¯ä»¥äº†

![image-20230719172758457](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719172758457.png)

ç„¶åå»ç”¨mysqldump çœ‹çœ‹æ˜¯å¦èƒ½çœ‹åˆ°è¿™ä¸ªå‡½æ•°

![image-20230719172920154](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719172920154.png)



## å…ˆçœ‹ä¸‹ä¸€ç§é”™è¯¯çš„mysqldump

å…¨å¤‡å¯ä»¥ä½¿ç”¨é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œ

mysqldump -uroot -pxxxx hellodb > /data/hellodb.sql

![image-20230719174253475](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719174253475.png)

æ‰€è°“mysqldump dbå…¶å®å°±æ˜¯ä¿å­˜äº†ä¹‹å‰é…ç½®çš„å„ç§å‘½ä»¤

![image-20230719174701959](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719174701959.png)

ä¸‹é¢å¼€å§‹åˆ©ç”¨è¿™ä¸ªdumpå‡ºæ¥çš„æ–‡ä»¶è¿›è¡Œè¿˜åŸæµ‹è¯•ï¼Œ

drop æ‰å…ˆ

<img src="2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719174830630.png" alt="image-20230719174830630" style="zoom:50%;" /> 



ç”±äºmysqldumpå‡ºæ¥çš„å¤‡ä»½æ–‡ä»¶ï¼Œä½ ä»¬æ²¡æœ‰åˆ›å»ºåº“çš„å‘½ä»¤ï¼Œæ‰€ä»¥è¿˜åŸä¹‹å‰è¦æ‰‹åŠ¨åˆ›å»ºåº“ã€‚

![image-20230719175136730](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719175136730.png)



åŒæ ·ç”±äºmysql dumpå‡ºæ¥çš„å†…å®¹é‡Œæ²¡æœ‰åˆ›å»ºæ•°æ®åº“ï¼Œæ‰€ä»¥ä½ æ‰‹åŠ¨åˆ›å»ºçš„æ—¶å€™å…¶å®å¯ä»¥æ”¹ä¸ªåå­—çš„ï¼Œ

![image-20230719181131116](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719181131116.png)

è¿›å»çœ‹ä¸€ä¸‹

<img src="2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719180254467.png" alt="image-20230719180254467" style="zoom:50%;" />

<img src="2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719180340044.png" alt="image-20230719180340044" style="zoom:67%;" /> 



1ã€è¿™ç§æ–¹æ³•å¤‡ä»½æ•°æ®å°±ä¸å¤ªå¥½äº†ã€‚ä¸‡ä¸€åŸæ¥çš„dbåç§°ä½ å¿˜äº†å‘¢ã€‚éšä¾¿å†™ä¸€ä¸ªï¼Œç”¨æˆ·é‚£è¾¹å‰ç«¯åº•å±‚sqlé‡Œé¢äººå®¶è¿˜æ˜¯è€çš„åº“åï¼Œä¸šåŠ¡è‚¯å®šæ¢å¤ä¸äº†çš„ã€‚

2ã€è¿˜ä¸€ä¸ªï¼Œç”±äºè¿™ç§mysqldumpå‡ºæ¥çš„sqlå†…å®¹é‡Œæ²¡æœ‰æ¶‰åŠåº“ï¼Œä¹Ÿå°±æ˜¯ä¸çŸ¥é“äººå®¶å½“åˆåˆ›å»ºåº“çš„æ—¶å€™æ˜¯å¦æ¶‰åŠäº†ä¸€äº›ç‰¹æ€§ï¼Œæ¯”å¦‚å­—ç¬¦é›†ï¼Œæ¯”å¦‚å¼•æ“ï¼Œç­‰ã€‚è¿™äº›éƒ½æ˜¯é—®é¢˜ã€‚





## mysqldump --databases | -B

åŸæ¥æ˜¯è¿™æ ·ğŸ‘‡

![image-20230719181627156](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719181627156.png)

ç°åœ¨æ”¹æˆè¿™æ ·ğŸ‘‡

![image-20230719181737703](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719181737703.png)

å†æ¥çœ‹å¤‡ä»½çš„æ–‡ä»¶ï¼Œæ­¤æ—¶-Bå°±ä¼šæœ‰åˆ›å»ºæ•°æ®åº“çš„å‘½ä»¤äº†

![image-20230719181834909](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719181834909.png)

åˆ åº“

![image-20230719182028795](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719182028795.png)

<img src="2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719182054440.png" alt="image-20230719182054440" style="zoom:50%;" />



ç„¶åæ¢å¤ä¸€ä¸‹ï¼Œæ­¤æ—¶å°±ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªå¯èƒ½éƒ½ä¸çŸ¥é“çš„å…·ä½“å‚æ•°çš„æ•°æ®åº“äº†

![image-20230719182250859](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719182250859.png)

![image-20230719182333475](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719182333475.png)

![image-20230719182351105](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719182351105.png)

åŒæ ·ä¹Ÿå¯ä»¥ä¸ç”¨cliäº¤äº’æ¨¡å¼ï¼Œä¸è¿‡-eçš„æ–¹å¼ï¼Œæ— éœ€è€ƒè™‘ç»“å°¾çš„åˆ†å·äº†;å°±

![image-20230719182635419](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719182635419.png)



### å¦‚æœä¸æ˜¯dropåˆ åº“ï¼Œè€Œæ˜¯åº“é‡Œçš„è¡¨æ ¼ä¸¢äº†ï¼Œä¹Ÿä¸€æ ·å¯ä»¥ç”¨è¿™ç§æ–¹å¼ï¼Œ

å› ä¸ºmysqldump -rtoot -pXXX -B hellodbé‡Œçš„createè¯­å¥é‡Œæ˜¯ç”±IF NOT EXISTSæ¡ä»¶åˆ¤æ–­çš„ã€‚

![image-20230719182852320](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719182852320.png)



### å¤‡ä»½å¤šä¸ªä¸€æ ·æ˜¯-B

![image-20230719183037926](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719183037926.png)

æ³¨æ„ä¸Šå›¾ä¸€æ ·hello mysqlå…¶å®ä¸åŠ -Bå°±åˆ¤å®šæœªhelloåº“é‡Œçš„mysqlè¡¨äº†ã€‚

![image-20230719183337051](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719183337051.png)

![image-20230719183432639](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719183432639.png)



### å†çœ‹çœ‹-Aå…¨å¤‡ï¼Œå°±æ˜¯ä¸å¤‡ä»½information_schemaå’Œperformance_schema

![image-20230719184026104](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719184026104.png)

æœç„¶å°‘äº†é‚£ä¸¤ä¸ªï¼šä¸€ä¸ªå…ƒæ•°æ®ï¼Œä¸€ä¸ªæ€§èƒ½

![image-20230719184742018](2-mysqlå¤‡ä»½è¿˜åŸmysqldumpä½¿ç”¨.assets/image-20230719184742018.png)
