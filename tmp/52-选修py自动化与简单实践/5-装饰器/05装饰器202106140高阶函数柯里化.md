# 05è£…é¥°å™¨202106140é«˜é˜¶å‡½æ•°æŸ¯é‡ŒåŒ–.md



åµŒå¥—å‡½æ•°

<img src="05è£…é¥°å™¨202106140é«˜é˜¶å‡½æ•°æŸ¯é‡ŒåŒ–.assets/image-20250120153517555.png" alt="image-20250120153517555" style="zoom:50%;" />



baseæ˜¯localï¼Œå‡½æ•°é‡Œçš„å‡½æ•°incè°ƒç”¨ä¸äº†localå˜é‡ï¼Œæ‰€ä»¥è¦nonlocalä¸€ä¸‹ã€‚



é«˜é˜¶å‡½æ•°çš„å®šä¹‰ï¼šä¼ å‚å’Œè¿”å›å€¼ æœ‰ä¸€ä¸ªæ˜¯å‡½æ•°å°±æ˜¯é«˜é˜¶å‡½æ•°



è¿™ä¸ªä¸æ˜¯é«˜é˜¶å‡½æ•°ğŸ‘‡

<img src="05è£…é¥°å™¨202106140é«˜é˜¶å‡½æ•°æŸ¯é‡ŒåŒ–.assets/image-20250120153944972.png" alt="image-20250120153944972" style="zoom:50%;" />





å¥½ç—›è‹¦ï¼Œè¿™ç©æ„çœ‹çš„ï¼Œå¤§è‡´èƒ½è·Ÿä¸Šï¼Œä½†æ˜¯ä¸å¼€å¿ƒï¼Œå› ä¸ºé—­åŒ…ã€å‡½æ•°æ¶ˆäº¡ã€å‹æ ˆã€æŒ‡é’ˆã€å †æ ˆã€f.\__closure\__è¿™äº›ä¸œè¥¿æˆ‘ä¹‹å‰å†™é‚£ä¹ˆå¤šéƒ½ä¸çŸ¥é“ä¹Ÿç”¨ä¸åˆ°è¿™ç©æ„ã€‚ä¸å–œæ¬¢



ç†è§£ï¼š

```python
def counter(base):
	def inc(step=1):
		nonlocal base
		base += step
		return base
	return inc

f = counter(10)
print(f()) # 11
print(f()) # 12 f.__closure__
```





ç†è§£ï¼š

```python
def counter(base):
	def inc(step=1):
		nonlocal base
		base += step
		return base
	return inc

f1 = counter(5)
f2 = counter(5)
print(f1 == f2)  # False
print(f1 is f2)  # False
```





![image-20250120174140025](05è£…é¥°å™¨202106140é«˜é˜¶å‡½æ•°æŸ¯é‡ŒåŒ–.assets/image-20250120174140025.png)



<img src="05è£…é¥°å™¨202106140é«˜é˜¶å‡½æ•°æŸ¯é‡ŒåŒ–.assets/image-20250120175806903.png" alt="image-20250120175806903" style="zoom:50%;" /> 





```python
def add(x, y, z):
	retrun x + y + z
	
å¸Œæœ›æŸ¯é‡ŒåŒ–ä¸º
add(4)(5, 6)
add(4, 5)(6)
add(4)(5)(6)
```

```python

def add(x):
    def fn(y,z):
        return x + y + z
    return fn
z = add(4)(5, 6)
print(z)

def add(x, y):
    def fn(z):
        return x + y + z
    return fn
z = add(4, 5)(6)
print(z)

def add(x):
    def cn(y):
        def fn(z):
            return x + y + z
        return fn
    return cn
z = add(4)(5)(6)
print(z)

```



















