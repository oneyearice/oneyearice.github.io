# ç¬¬5èŠ‚. mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹



### äºŒè¿›åˆ¶å®‰è£…

<img src="5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316110539246.png" alt="image-20230316110539246" style="zoom:40%;" /> 



MSIæ ¼å¼ç‚¹å‡»å®‰è£…å°±å¥½

![image-20230315103736071](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315103736071.png) 



#### ä¸€ã€åˆ›å»ºè´¦å·ä»¥åŠæ•°æ®åº“çš„ç›®å½•

ç¡®å®šæ²¡æœ‰ä½¿ç”¨è¯¥è´¦å·ï¼Œå†åˆ›å»º

```
(1) å‡†å¤‡ç”¨æˆ·
groupadd -r -g 306 mysql  # æ²¡å¿…è¦ï¼Œåˆ æ‰è¿™å¥ï¼Œæœ¬èº«useradd -r å°±ä¼šåˆ›å»ºåŒåç»„ï¼Œidéƒ½æ˜¯<1000çš„ç³»ç»ŸID
useradd -r â€“d /data/mysql mysql  # æ²¡å¿…è¦-d /data/mysql ï¼Œå› ä¸º-ræœ¬èº«ä¹Ÿä¸ä¼šåˆ›å»ºå®¶ç›®å½•å†™äº†ä¹Ÿç™½å†™
(2) å‡†å¤‡æ•°æ®ç›®å½•ï¼Œå»ºè®®ä½¿ç”¨é€»è¾‘å·
mkdir /data/mysql
chown mysql:mysql /data/mysql

```

<img src="5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315104501402.png" alt="image-20230315104501402" style="zoom:50%;" /> 

-rç³»ç»Ÿç”¨æˆ·äº†ï¼Œ-då°±ä¸ä¼šåˆ›å»ºå®¶ç›®å½•äº†ï¼Œæ‰€ä»¥æ²¡å¿…è¦-då¸¦ä¸Šç›®å½•ï¼Œ

æ‰€ä»¥åˆ›å»ºè´¦å·ä¼˜åŒ–ä¸º

```
useradd -r mysql
mkdir /data/mysql
chown mysql.mysql /data/mysql
```

æˆ–è€…

```
useradd -r -s /sbin/nologin -m -d /data/mysql mysql  # -må°±æ˜¯-rçš„æƒ…å†µä¸‹ä¸ä¼š-dæ‰€ä»¥å°±-m
cd /data/mysql
rm -rf /data/mysql/.*  # åˆ é™¤å®¶ç›®å½•é‡Œçš„éšè—æ–‡ä»¶ï¼Œå¦åˆ™ä¼šæœ‰é—®é¢˜

```

![image-20230315110417550](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315110417550.png) 



ç„¶åè¿™é‡Œå¼ºè°ƒä¸‹ useradd -s /bin/false å’Œ/sbin/nologinä¸€ä¸ªæ„æ€ï¼Œä¸è¿‡falseçš„æœ¬è´¨è¿˜æ˜¯

<img src="5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230907164449447.png" alt="image-20230907164449447" style="zoom:50%;" /> 

ä½ ç»™äº†ç”¨æˆ·/bin/false çš„shellåï¼Œç”¨æˆ·ç™»å…¥ä½¿ç”¨è¿™ä¸ª/bin/falseåå‘ç°è¿”å›çš„æ˜¯falseæ˜¯é”™è¯¯ï¼Œäºæ˜¯å°±ä¸ä¼šç»§ç»­ç™»å…¥äº†ã€‚





#### äºŒã€è§£å‹äºŒè¿›åˆ¶å’Œåˆ›å»ºè½¯è¿æ¥ä»¥åŠæ–‡ä»¶æƒé™

æ³¨æ„/usr/localè·¯å¾„æ˜¯å›ºå®šçš„ï¼Œå½“åˆå®˜æ–¹ç¼–è¯‘çš„æ—¶å€™æŒ‡å®šçš„

![image-20230315110614365](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315110614365.png)

è§£å‹åå°±å¾—åˆ°å¸¦ç‰ˆæœ¬å·çš„æ–‡ä»¶å¤¹ï¼Œå¤§å°ä»600M+å˜æˆäº†1.5G

![image-20230315110808010](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315110808010.png)

ä½†æ˜¯äººå®¶ç¼–è¯‘çš„æ—¶å€™çš„è·¯å¾„æ˜¯/usr/local/mysqlï¼Œæ‰€ä»¥åˆ›å»ºä¸€ä¸ªè½¯è¿æ¥

![image-20230315110939922](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315110939922.png)

æƒé™çš„é—®é¢˜

![image-20230315111441349](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315111441349.png)

![image-20230315111554390](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315111554390.png) 

![image-20230315111615945](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315111615945.png)

è§£é‡Šï¼šåŠ ä¸åŠ æ–œçº¿

1ã€chown -R root.root mysql   # msqlæ˜¯è½¯è¿æ¥æ–‡ä»¶ï¼Œ-Rä¹Ÿæ˜¯ä¸è®¤ä¸ºæ˜¯ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸å­˜åœ¨é€’å½’ã€

2ã€chown -R root.root mysql/  # è¿™æ ·å°±ä¼šåˆ¤å®šä¸ºæ–‡ä»¶å¤¹ï¼Œ-Rå°±ä¼šåšé€’å½’äº†

è¿™é‡Œå°±å®Œæˆäº†äºŒè¿›åˆ¶æ–‡ä»¶çš„è§£å‹ï¼Œå¾—åˆ°äº†ä¸€å †mysqlç¨‹åºã€‚ç„¶åè€ƒè™‘ä½¿ç”¨è¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶ç”ŸæˆDBæ–‡ä»¶ã€‚



#### ä¸‰ã€ç”Ÿæˆæ•°æ®åº“æ–‡ä»¶

ç°åœ¨/data/mysqlé‡Œæ˜¯ç©ºçš„

![image-20230315112151485](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315112151485.png) 

![image-20230315112230093](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315112230093.png) 

å…³æ³¨è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹

![image-20230315112349674](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315112349674.png) 

/usr/local/msyql/scriptsé‡Œçš„mysql_install_dbæ˜¯ç”¨æ¥åˆ›å»ºæ•°æ®åº“æ–‡ä»¶



åˆ›å»ºçš„æ—¶å€™è¦æŒ‡æ˜ï¼Œåœ¨å“ªä¸ªç›®å½•ä¸‹ç”ŸæˆDBæ–‡ä»¶ï¼Œå¹¶è¿™äº›æ–‡ä»¶å±äºå“ªä¸ªç”¨æˆ·

æ‰§è¡Œçš„æ—¶å€™æŠ¥é”™äº†

![image-20230315113455024](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315113455024.png) 



![image-20230315113731171](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315113731171.png) 

è§£å†³æ–¹æ³•æ˜¯åˆ°/usr/local/mysqlä¸‹ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ‰§è¡Œ

![image-20230315114030148](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315114030148.png) 

![image-20230315134035600](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315134035600.png)

è¿™å°±æ˜¯å®‰å…¨åŠ å›ºçš„æŒ‡ä»¤ğŸ‘†è¿è¡Œå®Œåï¼Œå°±ç”Ÿæˆäº†DBæ–‡ä»¶ğŸ‘‡

![image-20230315134119983](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315134119983.png)



é…ç½®æ–‡ä»¶ä¸€èˆ¬ç³»ç»Ÿè‡ªå¸¦å°±æœ‰ï¼Œä¹Ÿè¦çœ‹ä»€ä¹ˆç³»ç»Ÿå‘¢ï¼Œå¦‚æœæ˜¯æœ€å°åŒ–rocky-linuxå°±æ²¡æœ‰

![image-20230315135915680](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315135915680.png) 

å¯è§è¯¥/etc/my.cnfæ–‡ä»¶ä¸æ˜¯äºŒè¿›åˆ¶å®‰è£…å¾—æ¥çš„ã€‚



#### å››ã€ä»äºŒè¿›åˆ¶å®‰è£…åŒ…é‡Œæ‰¾åˆ°é…ç½®æ–‡ä»¶æ¨èæ¨¡æ¿å¤åˆ¶åˆ°å¸¸ç”¨é…ç½®æ–‡ä»¶è·¯å¾„ä¸‹

![image-20230315140139209](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315140139209.png)

![image-20230315140243332](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315140243332.png) 

![image-20230315140334239](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315140334239.png) 

è¿™äº›å‚æ•°å°±æ˜¯è€æ–‡ä»¶ä¿ç•™ä¸‹æ¥çš„ï¼Œç°åœ¨ä¸ä¼šç»™è¿™ä¹ˆå°çš„å†…å­˜ã€‚

![image-20230315140652697](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315140652697.png) 

å’ŒåŸæ¥çš„/etc/my.cnfåŒºåˆ«å¼€æ¥ï¼Œæ”¾åˆ°/etc/mysql/my.cnfğŸ‘†

ä¿®æ”¹/etc/mysql/my.cnfé‡Œçš„datadirä¸ºä¹‹å‰æŒ‡å®šçš„/data/mysqlï¼Œå…¶ä»–ä¸ç”¨åŠ¨

<img src="5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315140956584.png" alt="image-20230315140956584" style="zoom:60%;" /> 



####  äº”ã€å¯åŠ¨æœåŠ¡

ç”±äºæ˜¯äºŒè¿›åˆ¶å®‰è£…çš„ï¼Œå¯åŠ¨é è„šæœ¬

![image-20230315141348789](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315141348789.png)



è„šæœ¬é‡Œæœ‰start status stopè¿™äº›åŠ¨ä½œçš„

![image-20230315141324297](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315141324297.png) 



![image-20230315141525647](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315141525647.png) 

![image-20230315141633402](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315141633402.png) 

è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨äº†å·²ç»ğŸ‘†

ç„¶åå¯åŠ¨æœåŠ¡

![image-20230315141740330](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315141740330.png)





#### å…­ã€å®¢æˆ·ç«¯è¿æ¥



ä¿®æ”¹ä¸€ä¸‹PATHè·¯å¾„ï¼Œä¾¿äºä½¿ç”¨mysqlå‘½ä»¤

![image-20230315141842822](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315141842822.png)

![image-20230315142058883](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315142058883.png) 

PATHå˜é‡å†™åˆ°ç‹¬ç«‹çš„/etc/profile.d/mysql.shé‡Œ

![image-20230315142200340](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315142200340.png) 



æ­¤æ—¶å°±å¯ä»¥è¿æ¥mysqldäº†

![image-20230315142221195](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315142221195.png)



#### ä¸ƒã€å¼€å¤´æåˆ°çš„å®¶ç›®å½•é‡Œçš„éšè—æ–‡ä»¶çš„é—®é¢˜

å¦‚æœå½“åˆåˆ›å»ºç”¨æˆ·ä½¿ç”¨-m -dç”Ÿæˆäº†å®¶ç›®å½•æ¥ä½œä¸ºDBæ–‡ä»¶è·¯å¾„ï¼Œç„¶ååˆæ²¡æœ‰åˆ é™¤é‡Œé¢çš„éšè—æ–‡ä»¶å¤¹ï¼Œå°±ä¼šé‡åˆ°é—®é¢˜

![image-20230315142613253](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315142613253.png)

åˆ æ‰å°±å¥½äº†

![image-20230315142653243](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315142653243.png) 

![image-20230315142925485](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315142925485.png)

systemæ˜¯åœ¨mysqläº¤äº’ç•Œé¢é‡Œè°ƒç”¨linuxç³»ç»Ÿå‘½ä»¤ğŸ‘†ï¼Œå½“ç„¶è¿™é‡Œä»…ä»…æ˜¯æ¼”ç¤ºçŸ¥è¯†ç‚¹ï¼Œå·¥ä½œä¸­åƒä¸‡ä¸è¦è¿™ä¹ˆæ“ä½œï¼Œå¤ªå±é™©äº†ï¼Œæ•°æ®åº“æ–‡ä»¶éƒ½åœ¨é‚£å‘¢ã€‚

```shell
rm -rf .[^.]* è¿™æ˜¯åˆ é™¤éšè—æ–‡ä»¶çš„å‡†ç¡®æ–¹æ³•ã€‚	
```

![image-20230315143250509](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315143250509.png)



#### å…«ã€å®‰å…¨åŠ å›º

![image-20230315143452748](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315143452748.png) 

![image-20230315143555409](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315143555409.png) 

ä»¥ä¸Šå°±æ˜¯äºŒè¿›åˆ¶å®‰è£…æ–¹æ³•çš„è¯¦æƒ…ğŸ‘†



### æºç ç¼–è¯‘å®‰è£…

è€ƒè™‘åˆ°æ•°æ®åº“åé¢å¯èƒ½éœ€è¦æ‰©å®¹ï¼Œæ‰€ä»¥è¿™æ¬¡ä½¿ç”¨é€»è¾‘å·ã€‚

##### åˆ†åŒº

![image-20230315144555766](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315144555766.png)![image-20230315144629573](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315144629573.png) 

![image-20230315145443643](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315145443643.png)

![image-20230315145601333](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315145601333.png) 

æ³¨æ„ä¸Šå›¾ğŸ‘†error éœ€è¦åŒæ­¥ä¸€ä¸‹

![image-20230315145758854](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230315145758854.png) 



#### åˆ›å»ºç‰©ç†å·å¹¶åŠ å…¥å·ç»„

åŠ ç»„çš„æ—¶å€™ï¼ŒæŒ‡å®šå•ä¸ªPEå¤§å°ä¸º16Mï¼Œå°†æ¥ç©ºé—´å°±æ˜¯16Mï¼Œ16Måœ°åˆ†å‡ºå»çš„ã€‚

![image-20230316095357311](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316095357311.png) 



#### åˆ›å»ºé€»è¾‘å·

ç£ç›˜ç©ºé—´ç”¨å…‰100%free

![image-20230316101035597](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316101035597.png) 



#### æŒ‚è½½æ–‡ä»¶å¤¹

åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œè®°å¾—æ ¼å¼åŒ–LVM

![image-20230316101220484](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316101220484.png) 

![image-20230316101412040](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316101412040.png) 

æŒç»­æŒ‚è½½ğŸ‘†



æŸ¥çœ‹ç¡®è®¤ä¸‹

![image-20230316101449574](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316101449574.png) 



#### ä¿®æ”¹æ–‡ä»¶å¤¹å±æ€§

åˆ›å»ºè´¦å·å…ˆ

![image-20230316101620933](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316101620933.png) 



#### -------------å¼€å§‹æºç ç¼–è¯‘------------

#### **å®‰è£…ä¾èµ–åŒ…ğŸ‘†**

```shell
yum install bison bison-devel zlib-devel libcurl-devel libarchive-devel boost-  devel gcc gcc-c++ cmake ncurses-devel gnutls-devel libxml2-devel openssl-  devel libevent-devel libaio-devel
```



#### è§£å‹ç¼©æºç å‹ç¼©åŒ…å¹¶è¿›è¡Œç¼–è¯‘

![image-20230316101950830](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316101950830.png) 

![image-20230316102004655](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316102004655.png) 

![image-20230316102022180](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316102022180.png)

ç¼–è¯‘é‡‡ç”¨cmakeè€Œä¸æ˜¯configureé¢„ç¼–è¯‘ï¼Œè®°å¾—CPUç»™å¤Ÿï¼Œå¦åˆ™å¾…ä¼šmakeç¼–è¯‘çš„æ—¶å€™è€—æ—¶æ›´é•¿ï¼›

```shell
cd mariadb-10.2.18/  cmake . \
-DCMAKE_INSTALL_PREFIX=/app/mysql \           # è¿™ä¸ªæ˜¯äºŒè¿›åˆ¶ç¨‹åºå®‰è£…è·¯å¾„
-DMYSQL_DATADIR=/data/mysql/ \                # è¿™æ˜¯æ•°æ®åº“æ–‡ä»¶å­˜æ”¾è·¯å¾„
-DSYSCONFDIR=/etc/ \
-DMYSQL_USER=mysql \
-DWITH_INNOBASE_STORAGE_ENGINE=1 \
-DWITH_ARCHIVE_STORAGE_ENGINE=1 \
-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \
-DWITH_PARTITION_STORAGE_ENGINE=1 \
-DWITHOUT_MROONGA_STORAGE_ENGINE=1 \
-DWITH_DEBUG=0 \
-DWITH_READLINE=1 \
-DWITH_SSL=system \
-DWITH_ZLIB=system \
-DWITH_LIBWRAP=0 \
-DENABLED_LOCAL_INFILE=1 \
-DMYSQL_UNIX_ADDR=/data/mysql/mysql.sock \
-DDEFAULT_CHARSET=utf8 \
-DDEFAULT_COLLATION=utf8_general_ci
make && make install
```

æç¤ºï¼šå¦‚æœå‡ºé”™ï¼Œæ‰§è¡Œrm -f CMakeCache.txt

```shell
make -j 16 && make install && echo -e '\a' && date
```

![image-20230316103020251](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316103020251.png)

#### åç»­å®‰è£…å’ŒäºŒè¿›åˆ¶å®‰è£…ä¸€æ ·ğŸ‘‡

```
å‡†å¤‡ç¯å¢ƒå˜é‡
echo 'PATH=/app/mysql/bin:$PATH' > /etc/profile.d/mysql.sh
.	/etc/profile.d/mysql.sh
ç”Ÿæˆæ•°æ®åº“æ–‡ä»¶ cd	/app/mysql/
scripts/mysql_install_db --datadir=/data/mysql/ --user=mysql
å‡†å¤‡é…ç½®æ–‡ä»¶
cp  /app/mysql/support-files/my-huge.cnf	/etc/my.cnf
[mysqld]ä¸­æ·»åŠ ä¸‰ä¸ªé€‰é¡¹ï¼š  
datadir = /data/mysql  
innodb_file_per_table = on
skip_name_resolve = on	ç¦æ­¢ä¸»æœºåè§£æï¼Œå»ºè®®ä½¿ç”¨

å‡†å¤‡å¯åŠ¨è„šæœ¬
cp /app/mysql/support-files/mysql.server /etc/init.d/mysqld
å¯åŠ¨æœåŠ¡
chkconfig --add mysqld ;service mysqld start

```

è®°å½•ç¼–è¯‘å®‰è£…é‡åˆ°çš„é—®é¢˜

![image-20230316140057953](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316140057953.png) 

![image-20230331101324556](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230331101324556.png)



### å¤šå®ä¾‹mysql

å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥ç”¨dockerå’¯ï¼Œè¿™é‡Œå…ˆä¸ç®¡å®¹å™¨çš„äº‹

ä¸ç®¡æ˜¯å“ªç§ï¼Œç«¯å£å·å¿…é¡»åˆ†å¼€æ¥

#### å¼€å§‹æ“ä½œï¼Œä½¿ç”¨çš„æ˜¯yumå®‰è£…çš„mariadbè¿›è¡Œå®éªŒ

å½“å‰å•ä¸ªå®ä¾‹çš„æƒ…å†µ

##### 1ã€ç«¯å£ä¸€ä¸ª3306ï¼Œè¦åˆ†å¼€

![image-20230316112402636](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316112402636.png) 

##### 2ã€æ•°æ®æ–‡ä»¶è·¯å¾„ä¸€ä¸ªï¼Œè¦åˆ†å¼€

![image-20230316112539364](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316112539364.png) 

æ•°æ®åº“çš„è·¯å¾„yumå®‰è£…çš„æ˜¯è¿™é‡ŒğŸ‘†ï¼Œå¾…ä¼šè¦åšå¤šå®ä¾‹ï¼Œè·¯å¾„é‡æ–°è§„åˆ’æˆä¸‰ä¸ªç‹¬ç«‹çš„ã€‚

----

### â‘ åˆ›å»ºç‹¬ç«‹çš„ç›®å½•ç”¨æ¥å­˜æ”¾DBæ–‡ä»¶ã€binæ–‡ä»¶ã€etcé…ç½®æ–‡ä»¶ã€logæ—¥å¿—æ–‡ä»¶

![image-20230316112925342](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316112925342.png) 

![image-20230316112944307](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316112944307.png) 

socketå°±æ˜¯mysqlé€šè¿‡æœ¬åœ°socketè¿æ¥çš„æ–‡ä»¶ã€‚

![image-20230316113514834](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316113514834.png) 



### â‘¡è·‘æ•°æ®åº“ç”Ÿæˆçš„è„šæœ¬ï¼Œç”Ÿæˆå¤šä¸ªDBæ–‡ä»¶

å°±æ˜¯æŠŠyumå®‰è£…çš„/var/lib/mysql/ä¸‹çš„æ–‡ä»¶ï¼Œç”Ÿæˆåˆ°è‡ªå·±åˆ›å»ºçš„å¤šä¸ªåˆ†å¼€çš„è·¯å¾„é‡Œ

![image-20230316113839359](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316113839359.png) 

yumå®‰è£…å°±ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªæ–‡ä»¶mysql_install_dbï¼Œç”¨å®ƒæ¥ç”ŸæˆDBæ–‡ä»¶

![image-20230316113947400](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316113947400.png) 

å¦‚æœæ˜¯äºŒè¿›åˆ¶å®‰è£…çš„å°±æ˜¯åœ¨scriptsè·¯å¾„ä¸‹ï¼Œæ³¨æ„ä¸è¦è¿›å»è¿è¡Œï¼Œå°±æ˜¯åœ¨å¤–é¢è¿è¡Œã€‚

ç”ŸæˆåŠ¨ä½œğŸ‘‡

![image-20230316114147794](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316114147794.png)yumå®‰è£…çš„æ—¶å€™è‡ªå¸¦è„šæœ¬å°±ä¼šåˆ›å»ºmysqlç”¨æˆ·ï¼Œæ‰€ä»¥ç›´æ¥ç”¨å°±è¡Œäº†ğŸ‘†

--datadir æŒ‡å®šDBæ–‡ä»¶ç›®å½•

treeå¯è§ å·²ç”Ÿæˆäº†

<img src="5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316114317478.png" alt="image-20230316114317478" style="zoom:50%;" /> 

åŒæ ·å¦å¤–ä¸¤ä»½ç”Ÿæˆä¸€ä¸‹ï¼š

![image-20230316114419611](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316114419611.png) 

![image-20230316114437740](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316114437740.png)



### â‘¢ä¿®æ”¹ç›®å½•çš„æƒé™

å·²ç»é€šè¿‡mysql_install_dbç”ŸæˆæŒ‡å®šçš„æƒé™å¦‚ä¸‹

![image-20230316114809221](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316114809221.png) 

æ•´ä¸ªç›®å½•éƒ½è®¾ç½®ä¸€ä¸‹

![image-20230316114953032](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316114953032.png)



### â‘£åˆ›å»ºå¤šå®ä¾‹çš„é…ç½®æ–‡ä»¶

å°±æ”¾åˆ°åˆšæ‰å®šä¹‰çš„å¤šå®ä¾‹æ–‡ä»¶å¤¹ä¸‹å„ä¸ª/etcä¸‹

![image-20230316115159108](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316115159108.png) 

å…ˆæ”¹ä¸€ä»½ï¼Œå†å¤åˆ¶åˆ°å…¶ä»–å®ä¾‹è·¯å¾„ä¸‹

![image-20230316115508449](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316115508449.png)

å› ä¸ºæ˜¯å¤šå®ä¾‹ï¼ŒPORTé»˜è®¤æ˜¯3306ä¹Ÿé¡ºä¾¿ç»Ÿä¸€éƒ½å†™ä¸Š

![image-20230316115801565](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316115801565.png)

ä¸Šé¢çš„é…ç½®ä¼˜åŒ–æˆå˜é‡çš„æ–¹å¼ï¼Œå¯ä»¥å—ï¼Œå“ˆå“ˆ

![image-20230316115632862](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316115632862.png)

ä¿®æ”¹ä¸€ä¸‹å„è‡ªçš„ç«¯å£

![image-20230316120056586](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316120056586.png)

![image-20230316120016038](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316120016038.png)



è‡³æ­¤ äºŒè¿›åˆ¶æ–‡ä»¶æœ¬æ¥å…±ç”¨çš„ä¸ç”¨åŠ¨ã€è´¦å·å…±ç”¨ä¸ç”¨åŠ¨ã€DBæ–‡ä»¶æå®šã€é…ç½®æ–‡ä»¶æå®šã€å°±å‰©ä¸‹å¯åŠ¨è„šæœ¬äº†ã€‚é‚£äº›socketè·¯å¾„ã€pidã€logéƒ½æ˜¯æŒ‡å®šåéšç€æœåŠ¡å¯åŠ¨ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ã€‚



### â‘¤å¯åŠ¨çš„æ–¹å¼ï¼Œé‡‡ç”¨è„šæœ¬åå°å¯åŠ¨

æœåŠ¡è„šæœ¬æ˜¯ç½‘ä¸Šæ‰¾ï¼Œæˆ–è€…è‡ªå·±å†™

æ‹–è¿›å»å³å¯

![image-20230316120640541](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316120640541.png)

è¿™ä¸ªè„šæœ¬çš„è·¯å¾„è¦ä¿®æ”¹çš„ï¼Œå› ä¸ºå®ƒåŸæœ¬æ˜¯é’ˆå¯¹æºç ç¼–è¯‘å®‰è£…çš„

æ¯”å¦‚mysqld_safeå’Œmysqldçš„è·¯å¾„å½“å‰æ‰€åœ¨ğŸ‘‡

![image-20230316121039855](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316121039855.png)

æ‰¾ä¸åˆ°æ˜¯å› ä¸ºwhichæ˜¯åªåœ¨PATHè·¯å¾„é‡Œæœç´¢çš„ï¼Œæ‹›ä¸åˆ°æ²¡äº‹ï¼ŒæœåŠ¡èµ·ä¸€ä¸‹ï¼Œps auxå¯è§

![image-20230316121148417](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316121148417.png)

![image-20230316121502453](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316121502453.png) 

å¯åŠ¨åå°±èƒ½çœ‹åˆ°mysqldçš„è·¯å¾„

![image-20230316134336619](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316134336619.png)

ä¿®æ”¹çš„æˆªå›¾

![image-20230316135102121](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316135102121.png)

![image-20230316135123909](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316135123909.png)

![image-20230316135155283](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316135155283.png)

![image-20230316135425910](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316135425910.png)

![image-20230316135503965](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316135503965.png)



è‡³æ­¤å°±æå®Œäº†

![image-20230316135545789](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316135545789.png)

3306è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„binä¸‹çš„å¯åŠ¨è„šæœ¬å°±æœ‰äº†

dataä¸‹çš„DBæ–‡ä»¶ä¹Ÿå°±æ˜¯æ•°æ®åº“ä¹Ÿæœ‰äº†

etcä¸‹çš„é…ç½®æ–‡ä»¶ä¹Ÿæœ‰äº†

log ã€pid ã€socket è¿™äº›è‡ªåŠ¨ç”Ÿæˆçš„

<img src="5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316135927290.png" alt="image-20230316135927290" style="zoom:50%;" /> 

**å¯åŠ¨ç¨‹åº**

![image-20230316140832942](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316140832942.png)

![image-20230316140645372](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316140645372.png)

![image-20230316141235612](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316141235612.png) 

![image-20230316141308338](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316141308338.png) 



![image-20230316141452307](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316141452307.png)



### â‘¥æ€ä¹ˆè¿æ¥

![image-20230316141957358](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316141957358.png)

æŒ‡å®šå„è‡ªçš„socketæ–‡ä»¶

![image-20230316142031366](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142031366.png)

![image-20230316142146342](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142146342.png)

statusçœ‹ä¸‹è·¯å¾„

![image-20230316142227593](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142227593.png)

3307çš„ğŸ‘‡

![image-20230316142247500](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142247500.png)

![image-20230316142316842](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142316842.png)

3308ğŸ‘‡

![image-20230316142333893](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142333893.png)

![image-20230316142348019](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142348019.png)



### â‘¦å…³é—­æ•°æ®åº“

![image-20230316142607288](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142607288.png)

æŠ¥é”™äº†ğŸ‘†

åº”ä¸ºæœåŠ¡å¯åŠ¨å…³é—­çš„é‚£ä¸ªè„šæœ¬é‡Œå†™äº†å›ºå®šçš„å£ä»¤ï¼Œå£ä»¤æ˜¯é”™çš„

![image-20230316142722001](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142722001.png)

![image-20230316142739815](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142739815.png)

å°±å¯ä»¥å•¦ğŸ‘†

é€šè¿‡ss -tlnpçœ‹çœ‹æ˜¯ä¸æ˜¯å…³æ‰äº†3308è¿™ä¸ªå®ä¾‹

![image-20230316142811867](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142811867.png)



### â‘§è¡¥ä¸Šrootçš„å£ä»¤

![image-20230316142930098](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316142930098.png)

è®°å¾—æ”¹çš„æ—¶å€™ä¹Ÿå¸¦ä¸Šsocketå‚æ•°-S

æ”¹å®Œå£ä»¤ï¼Œç”±äºåŸæ¥æ˜¯ç©ºå£ä»¤æ‰€ä»¥ç°åœ¨å¿…é¡»å¸¦å¯†ç æ‰èƒ½ç™»å…¥äº†

![image-20230316143031787](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316143031787.png)

![image-20230316143045845](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316143045845.png)

æŠŠå¯åŠ¨å…³é—­è„šæœ¬é‡Œçš„å¯†ç è¡¥å›å»ğŸ‘‡ï¼Œå¦åˆ™å…³é—­æœåŠ¡è¿˜å¾—è¾“å…¥å¯†ç ã€‚

![image-20230316143131497](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316143131497.png)



![image-20230316143212006](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316143212006.png)



åŒæ ·ä¿®æ”¹å¦å¤–ä¸¤ä¸ªå®ä¾‹çš„å¯†ç 

![image-20230316143649510](5-mysqläºŒè¿›åˆ¶å’Œæºç ç¼–è¯‘å®‰è£…åŠå¤šå®ä¾‹.assets/image-20230316143649510.png)



