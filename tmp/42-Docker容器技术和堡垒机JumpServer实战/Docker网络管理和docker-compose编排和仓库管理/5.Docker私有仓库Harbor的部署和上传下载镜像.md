# ç¬¬5èŠ‚ Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ



# ç®€è¿°

å®˜æ–¹çš„hub.docker.comçš„ä¸Šä¼ ![image-20240619094400007](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619094400007.png)

æ¯”å¦‚è‡ªå·±çš„ä¸€ä¸ªimageæ¨ä¸Šå»

```shell
docker tag openvpn:v001 oneyearice/openvpn:v001  # æ‰“æ ‡ç­¾å°±æ˜¯hub.docker.comçš„è´¦å·/é•œåƒ+tag

```



1ã€æ³¨å†Œè´¦å·





2ã€æ‰“æ ‡ç­¾ï¼Œæ‰“çš„æ˜¯ä»“åº“çš„IDå’Œé•œåƒä¿¡æ¯ï¼Œå¾…ä¼šç™»å…¥å“ªä¸ªä»“åº“å°±ç”¨å“ªä¸ªä»“åº“çš„IDã€‚

![image-20240619094933932](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619094933932.png)



3ã€ç™»å…¥æŒ‡å®šä»“åº“ï¼Œä¸æŒ‡å®šå°±æ˜¯å®˜æ–¹hub.docker.com

![image-20240619094921187](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619094921187.png)



![image-20240619095814308](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619095814308.png)

å¯†ç æœ¬åœ°æ˜¯å­˜èµ·æ¥äº†ï¼Œè€Œä¸”æ˜¯æ–‡æ˜çš„ğŸ‘‡ï¼Œå°±æ˜¯base64æ ¼å¼çš„è€Œå·²ï¼Œå¯ä»¥è½¬

![image-20240619100222914](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619100222914.png)

æœç„¶echo xxx |base64 -då°±è½¬å›æ¥äº†

![image-20240620161744872](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620161744872.png)



4ã€push

![image-20240619101717317](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619101717317.png)

æŠ¥é”™äº†ï¼Œå¥½åƒæ˜¯ä¸¤ä¸ªè´¦å·å†²çªäº†ï¼Œå°±æ˜¯ï¼Œoneyearice/è¿™ä¸ªè·¯å¾„ï¼Œçš„ç”¨oneyeariceè¿™ä¸ªè´¦å·æ¥ç™»å…¥ï¼Œç»“æœä¸Šé¢ç”¨çš„æ˜¯oneyearice@gmail.comç™»å…¥çš„ï¼Œè¿™ä¸ªè´¦å·çš„ä¸»ç›®å½•æ˜¯oneyeariceXXXæ˜¯ä»Šå¤©åˆšåˆšæ³¨å†Œçš„ï¼Œdeactiveè¿™ä¸ªè´¦å·å°±è¡Œäº†ã€‚

![image-20240619102741838](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619102741838.png)





å…¶å®å¯ä»¥ä¸å¿…ç”¨hub.docker.comçš„è´¦å·å¯†ç ï¼Œå¯ä»¥ç”¨ä¸“é—¨çš„access token



![image-20240619103035882](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619103035882.png)



![image-20240619103019513](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619103019513.png)







# Harbor

Vmwareå…¬å¸åšçš„

https://goharbor.io/

https://goharbor.io/docs/2.11.0/

https://github.com/vmware/

https://github.com/vmware/harbor



ç»„æˆï¼š

![image-20240619143936396](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619143936396.png)



![img](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/2238907-20211029101805703-890031358.png)



![image-20240619143953244](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619143953244.png)







harboræ˜¯åå‡ ä¸ªå®¹å™¨ç»„æˆçš„ï¼š

1ã€nginxï¼šnginxåšåä»£ï¼Œè¿™æ˜¯ä¸€ä¸ªå®¹å™¨ï¼›ç»™åç«¯å„ç§æœåŠ¡æä¾›åä»£

2ã€AdminServerï¼šå¯¹åº”å¯åŠ¨ç»„ä»¶harbor-admin serverï¼Œæ˜¯ç³»ç»Ÿçš„é…ç½®ç®¡ç†ä¸­å¿ƒé™„å¸¦æ£€æŸ¥å­˜å‚¨ç”¨é‡ï¼Œuiå’Œjobserverå¯åŠ¨æ—¶éœ€è¦åŠ è½½adminserveré…ç½®ã€‚

3ã€UIï¼šä»¥UIä¸ºå‰ç«¯çš„core serviceï¼šæ¶‰åŠUIã€APIã€Authï¼Œè€ŒAuth

4ã€APIï¼š

5ã€Authï¼šå¯¹æ¥AD/LDAP

6ã€AD/LDAP

7ã€LogCollector

8ã€DB

9ã€ReplicationService

10ã€Basic Registry



å®˜æ–¹æä¾›äº†è¿™äº›å®¹å™¨ç»„ä»¶å¯åŠ¨çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯docker-compolseçš„ymlæ–‡ä»¶ã€‚

# å®‰è£…Harbor

1ã€å®‰è£…docker

2ã€å®‰è£…docker-comose

ç„¶ådocker-composeåˆæ˜¯ä¾èµ–dockeræœåŠ¡çš„ï¼Œæ‰€ä»¥harborçš„å¯åŠ¨å°±éœ€è¦docker+docker-compose

3ã€ä¸‹è½½harborç¦»çº¿åŒ…

![image-20240619144515411](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619144515411.png)



![image-20240619144531125](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619144531125.png)



4ã€è§£å‹

![image-20240619145318811](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619145318811.png)

harborå†…éƒ¨æ‰€æœ‰åŠŸèƒ½ç»„ä»¶éƒ½æ˜¯ç”¨å®¹å™¨æä¾›çš„ï¼Œè€Œå®¹å™¨çš„é•œåƒéƒ½åœ¨harbor.v2.11.0.tar.gzè¿™ä¸ªåŒ…é‡Œäº†ï¼Œè¿™å°±æ˜¯æ‰€æœ‰imagesçš„æ‰“åŒ…æ–‡ä»¶ã€‚ç›¸å½“äºdocker save

![image-20240619145600057](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619145600057.png)

tar tvfé¢„è§ˆä¸€ä¸‹ï¼Œå¯è§éƒ½æ˜¯åˆ†å±‚é•œåƒæ–‡ä»¶ğŸ‘‡

![image-20240619145837255](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619145837255.png)

ç„¶åç†è®ºä¸Šå°±æ˜¯docker loadå¯¼å‡ºimagesï¼Œä½†æ˜¯äººå®¶æä¾›äº†è„šæœ¬ç»™ä½ äº†ğŸ‘‡ï¼Œè„šæœ¬é‡Œé¢å°±æœ‰docker load å‘½ä»¤

![image-20240619150258943](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619150258943.png)

è¿™ä¸ªè¿˜ä¸æ˜¯docker-compose.ymlæ–‡ä»¶å“¦ï¼Œåç¼€åä¹Ÿè¦æ”¹æˆymlğŸ‘‡ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯åˆå§‹åŒ–æ–‡ä»¶ï¼Œå°†æ¥è·‘å®Œinstall.shåï¼Œä¼šç”Ÿæˆdocker-comose.ymlæ–‡ä»¶çš„ã€‚

![image-20240619154621215](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619154621215.png)



5ã€ä¿®æ”¹ymlæ–‡ä»¶

![image-20240619155236366](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619155236366.png)

ä¿®æ”¹éƒ¨åˆ†å†…å®¹ğŸ‘‡

â‘ harborçš„è®¿é—®åŸŸåæˆ–è€…IP

![image-20240619155342824](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619155342824.png)

â‘¡sslè¯ä¹¦å¯ä»¥å…³æ‰ï¼Œå®éªŒç”¨æ— æ‰€è°“

![image-20240619155530333](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619155530333.png)

â‘¢é»˜è®¤çš„adminè´¦å·å¯†ç 

![image-20240619155656533](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619155656533.png)

å…¶ä»–ä¸ç”¨ä¿®æ”¹

metricæ˜¯Prometheusç›‘æ§ç”¨ğŸ‘‡

![image-20240619155908185](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619155908185.png)





6ã€è¿è¡Œinstall.shè¿›è¡Œå®‰è£…

æ—©æœŸéœ€è¦å®‰è£…pythonç¯å¢ƒï¼Œç°åœ¨pythonéƒ½æ˜¯è‡ªå¸¦äº†ï¼Œç‰ˆæœ¬ä¹Ÿä¸ä½ã€‚

![image-20240619170113744](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619170113744.png)

åŠ è½½é•œåƒğŸ‘‡

![image-20240619171427185](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619171427185.png)

å…¶åå°±ä¼šåˆ›å»ºdocker-compose.ymlæ–‡ä»¶ï¼Œç„¶åå°±ä¼šä½¿ç”¨docker-compose up -då•¦ğŸ‘‡

![image-20240619183405420](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619183405420.png)

å¯è§proxyå°±æ˜¯nginxå•¦ï¼Œç„¶åè®¿é—®ä¸€ä¸‹å°±OKäº†

![image-20240619183910224](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619183910224.png)



![image-20240619183926266](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240619183926266.png)



å…³æœºä¸‹ç­~~



å¼€æœºå‘ç°harborçš„è¿™ä¸ªå‡ ä¸ªå®¹å™¨å°±æ²¡æœ‰èµ·æ¥å‡ ä¸ª

![image-20240620102508523](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620102508523.png)

åŸå› å¯ä»¥çœ‹logsï¼Œä½†æ˜¯çœ‹ä¸å‡ºä¸ªæ‰€ä»¥ç„¶æ¥

ä½†æŸ¥çœ‹docker-compose.ymlé‡Œå¯è§å¾ˆå¤šéƒ½æ˜¯æœ‰ä¾èµ–å…³ç³»çš„ï¼ŒçŒœæµ‹åŸå› å¦‚ä¸‹

1ã€å¼€æœºå¯åŠ¨äº†dockerï¼Œsystemctl enable docker

2ã€dockerèµ·æ¥äº†ä»¥åï¼Œè¿™äº›å®¹å™¨å°±ç«‹é©¬restart alwaysäº†

![image-20240620103342937](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620103342937.png)

ä½†æ˜¯æœ‰ä¾èµ–çš„

![image-20240620105407047](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620105407047.png)

çœ‹ğŸ‘†å›¾ï¼Œå¯ä»¥å¾—å‡ºä¸¤ç‚¹ç»“è®º

â‘ åæœ‰å…«ä¹æ˜¯å› ä¸ºå­˜åœ¨ä¾èµ–å¯åŠ¨å…³ç³»ï¼Œæ‰å¯¼è‡´ä¸€çªèœ‚çš„restart alwaysæ²¡æœ‰å¯åŠ¨å¾—èµ·æ¥

â˜… çœ‹æ¥å…‰æœ‰restart alwaysä¸å¤Ÿï¼Œè¿˜éœ€è¦daemon.jsoné‡Œçš„live-strore trueæ¥è¾…åŠ©ï¼

â‘¡ç¬”è€…å…·æœ‰æ·±åšçš„sedæŠ€èƒ½ç†è§£èƒ½åŠ›ï¼Œæ­¤ä¹ƒé€šæ‰çš„æ½œè´¨~~~ï¼Œè§£é‡Šä¸‹ï¼Œè¿™é‡Œçš„sed é‡Œçš„åˆ†å·çš„é€»è¾‘å…¶å®æ˜¯å­˜åœ¨ä¸¤ç§åŠ¨æ€çš„é€»è¾‘çš„ï¼š1ã€å°±æ˜¯æˆ–è€…  2ã€å°±æ˜¯å¹¶ä¸”ï¼Œå“ˆå“ˆå“ˆä¸ç›¸ä¿¡ï¼Ÿä¸€ä¸ªsedé‡Œçš„å¤šä¸ªè¯­å¥ç”¨åˆ†å·éš”å¼€ï¼Œç¬”è€…ä¹Ÿå°±æ˜¯æœ¬å¤§çˆ·ç«Ÿç„¶æ‰¯çŠŠå­è¯´æ—¢æœ‰æˆ–è€… ä¹Ÿæœ‰ å¹¶ä¸”çš„é€»è¾‘ï¼Œå“ˆå“ˆå“ˆï¼Œä¸ä¿¡ä½ çœ‹

![image-20240620105802659](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620105802659.png)

æ—©åœ¨ä¸€å¹´å‰å°±æ¢³ç†å‡ºæ¥äº†



å†æ¬¡éªŒè¯è¯´æ˜

1ã€å¦‚ä¸Šä¸Šå›¾çš„sedå–å‡ºdocker-compose.ymlé‡Œçš„å…³é”®è¯ container_nameã€restartã€ä»¥åŠdepends_onçš„å­æ¨¡å—å†…å®¹ã€‚

è¿™ä¸ªå°±æ˜¯å…¸å‹çš„æˆ–è€…



2ã€ç„¶åä¸Šå›¾ä¹‹å‰çš„sedä¸“æ é‡Œï¼ŒåŒæ ·ä½¿ç”¨

![image-20240620110245998](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620110245998.png)

æ¥è¯´æ˜äº†æ­¤æ—¶  sed é‡Œ å¤šä¸ª;åˆ†å·é—´éš”çš„ æˆ–è€… å…³ç³»ï¼›æ˜¯ä¸ç­‰ä»·äºå¤šä¸ª ç®¡é“ç¬¦ é€’å½’çš„ã€‚



1å’Œ2å°±æ˜¯  æˆ–è€…é€»è¾‘   å­˜åœ¨äº  æŒ‘é€‰å†…å®¹çš„æ—¶å€™



3ã€åœ¨åˆ é™¤å†…å®¹çš„æ—¶å€™ï¼Œåˆ†å·ä»£è¡¨çš„é€»è¾‘å°±æ˜¯å¹¶ä¸”

![image-20240620110802631](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620110802631.png)



4ã€æ‰€ä»¥sed é‡Œçš„ å¤šä¸ªåŠ¨ä½œç”¨åˆ†å·éš”ç¦»ï¼Œå¤šä¸ªåŠ¨ä½œä¹‹é—´çš„å…³ç³» 

æ˜¯**å¹¶ä¸”**ï¼Œæ­¤æ—¶ç­‰ä»·äºå¤šä¸ªgrepï¼›å¹¶ä¸”çš„é€»è¾‘å­˜åœ¨äºå–ä¸œè¥¿

æ˜¯**æˆ–è€…**ï¼Œæ­¤æ—¶ä¸ç­‰ä»·äºå¤šä¸ªgrepï¼›æˆ–è€…çš„é€»è¾‘å­˜åœ¨äºå»ä¸œè¥¿ã€‚



5ã€**æ–¹æ³•è®º**ï¼šå½“ä½ ç”¨sed **å–**ä¸œè¥¿çš„æ—¶å€™ï¼Œä¸€ä¸ªsedé‡Œçš„åˆ†å·ä¹‹é—´çš„åŠ¨ä½œ å°±æ˜¯ **æˆ–è€…**

å½“ä½ ç”¨sed **å» **ä¸œè¥¿çš„æ—¶å€™ï¼Œä¸€ä¸ªsedé‡Œçš„åˆ†å·ä¹‹é—´çš„åŠ¨ä½œå°± **å¹¶ä¸”é€’è¿›**



æ€ä¹ˆç†è§£åˆ°ç”Ÿæ´»ä¸­æ¥å‘¢ï¼Œå°±æ˜¯ä¸Šå›¾ç”Ÿæ´»åŒ–çš„ä¾‹å­ï¼Œè¿™é‡Œå†æ¬¡æ¢³ç†

ä¸€ä¸ªA4çº¸ï¼Œå¥½æ¯”ä½ è¦ç”¨sedå¤„ç†çš„å¯¹è±¡ï¼›ä½ æœ‰ä¸¤ç§åŠ¨ä½œï¼Œ

ç¬¬ä¸€ç§åŠ¨ä½œ ä»A4çº¸ä¸Š å–ä¸¤ä¸ªå°å½¢çŠ¶ï¼Œæ­¤æ—¶å°±æ˜¯ æˆ–è€…çš„å…³ç³»

![sed_or](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/sed_or.gif)



å–å‡ºç¬¬ä¸€ä¸ªå°åœ†ç‰‡(^_^) ä½œä¸ºç»“æœæ˜¯ä¸å¯èƒ½è¢«grepå‡ºä¸€ä¸ªä¸‰è§’å½¢çš„ï¼Œå°±å¥½æ¯”ä½ å–å‡ºå­—æ¯Aï¼Œç„¶åAé‡ŒgrepBå‡ºæ¥æ˜¯ä¸å¯èƒ½çš„ã€‚



ç¬¬äºŒç§åŠ¨ä½œ å°†A4çº¸ å»æ‰ ä¸¤ä¸ªå°åœ†ç‰‡ï¼Œæ­¤æ—¶å°±æ˜¯ å¹¶ä¸”çš„å…³ç³»

![sed_and](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/sed_and.gif)



å»æ‰ä¸€ä¸ªå°åœ†ç‰‡çš„ç»“æœæ˜¯èƒŒæ™¯çš„A4çº¸ï¼Œæ­¤æ—¶è‡ªç„¶å¯ä»¥äº¤ç»™grepå†æ¬¡å»æ‰å¦ä¸€ä¸ªå°ä¸‰è§’çš„ã€‚è¿™å°±æ˜¯å¹¶ä¸”é€’è¿›çš„å…³ç³»ã€‚



é‚£å°±èµ·ä¸ªåå­—å§ï¼Œå°±å«åšè’™é¢ä¾ æ•ˆåº”~ ä¸Šé¢çš„GIFæœ€ç»ˆåƒä¸åƒçœ¼ç½©ï¼Œé‚£ä¸å°±æ˜¯è’™é¢ä¾ å˜›~

æ‰€ä»¥å“¥ä»¬ä¸‹æ¬¡å’Œäººå¹ç‰›é€¼ï¼Œå°±ä¼šè¯´sedæœ‰ä¸€ä¸ªè’™é¢ä¾ æ•ˆåº”~ï¼Œç„¶åè§‚å¯Ÿå¯¹æ–¹è¡¨æƒ…ï¼Œé…Œæƒ…è¿›ä¸€æ­¥è§£é‡Šï¼Œå½“ç„¶å¯¹æ–¹åœ¨åŠªåŠ›å¬æ˜ç™½åä¼šæç„¶å¤§æ‚Ÿ åŸæ¥å¦‚æ­¤ï¼Œç„¶åå°±å¿˜è®°äº†è’™é¢ä¾ è¿™ä¸ªèµ·å› è¯æ±‡ï¼Œå½“ç„¶è„‘å­å¿«çš„ä¼šé—®ä¸€å¥è’™é¢ä¾ æ˜¯ä»€ä¹ˆé¬¼~~~



å¥½äº†ç»§ç»­Harbor





æ‰“å¼€harborç®¡ç†é¡µé¢

![image-20240620134719310](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620134719310.png)

å…¬å¼€æ˜¯æŒ‡ ä¸‹è½½çš„æ—¶å€™æ˜¯å¦éœ€è¦loginã€‚ ä¸Šä¼ æ€ä¹ˆç€éƒ½éœ€è¦loginçš„ã€‚



![image-20240620141803553](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620141803553.png)

é¡¹ç›®å½’å±æˆå‘˜



ç„¶åç”¨user1æ¨ä¸€ä¸ªé•œåƒä¸Šæ¥

![image-20240620142440244](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620142440244.png)

åŸŸåæ˜¯å½“åˆè¿™é‡Œé…ç½®çš„

![image-20240620142856890](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620142856890.png)



```shell
docker tag SOURCE_IMAGE[:TAG] harbor.oneyearice.org/project001/REPOSITORY[:TAG]

docker push harbor.oneyearice.org/project001/REPOSITORY[:TAG]

```

![image-20240620143513491](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620143513491.png)

ç›´æ¥æ¨æ˜¯æ¨ä¸ä¸Šå»çš„ï¼Œä¸ä»…ä»…æ˜¯å› ä¸ºæ²¡æœ‰loginï¼Œè€Œä¸”é»˜è®¤æ˜¯èµ°çš„443ğŸ‘‡

![image-20240620143555884](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620143555884.png)

æ‰€ä»¥è¦loginï¼Œè¿˜è¦è§£å†³é»˜è®¤èµ°443çš„é—®é¢˜

1ã€è§£å†³443é—®é¢˜

![image-20240620144451945](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620144451945.png)

å†™åŸŸåå†™IPéƒ½è¡Œ

![image-20240620144820896](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620144820896.png)

è¿™ä¸ªrefusedå°±æ˜¯80ç«¯å£å®é™…ä¸Šæ²¡äº†

![image-20240620150900643](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620150900643.png)



é‡æ–°upä¸€ä¸‹å°±å¯¹äº†

![image-20240620151147317](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620151147317.png)

æ­¤æ—¶å°±æ˜¯æ²¡æœ‰loginçš„äº‹äº†



![image-20240620151221409](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620151221409.png)

å°±å¥½äº†

![image-20240620151315193](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620151315193.png)

æ­¤æ—¶ç½‘é¡µä¸Šå°±çœ‹åˆ°äº†ğŸ‘†



å‘ç°é•œåƒç‚¹è¿›å»ä¸€äº›æ“ä½œéƒ½æ˜¯ç°çš„çš„

![image-20240620162857196](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620162857196.png)

å”‰~~ç¬¨å‘ï¼Œå‹¾é€‰ä¸€ä¸‹å°±å¥½äº†

![image-20240620165109443](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620165109443.png)



å¯ä»¥æ‹‰çš„

![image-20240620164248181](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620164248181.png)



ç”¨å¤åˆ¶çš„CLIå°±æ˜¯ä¸€ä¸²ç¼–ç 

![image-20240620165305728](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620165305728.png)

ä¸€æ ·å¥½ç”¨çš„

![image-20240620165243292](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620165243292.png)





æ•ˆæœä¸€æ ·çš„ğŸ‘‡ï¼Œå…¶å®å°±æ˜¯ç‰ˆæœ¬tagå¾€å¾€ä¹Ÿå°±æ˜¯å“ˆå¸Œå€¼æ¥åšä¸€æ ·çš„æ•ˆæœã€‚

![image-20240620165622752](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620165622752.png)

![image-20240620165705347](5-Dockerç§æœ‰ä»“åº“Harborçš„éƒ¨ç½²å’Œä¸Šä¼ ä¸‹è½½é•œåƒ.assets/image-20240620165705347.png)































