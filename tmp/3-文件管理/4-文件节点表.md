# 第4节. 文件节点表



 

## 文件的存放有inode表格和data表格



![image-20220110160637127](4-文件节点表.assets/image-20220110160637127.png) 

上图可见，创建一个文件夹后，inode就占掉一个。

![image-20220110161211321](4-文件节点表.assets/image-20220110161211321.png) 

touch命令本身不支持这么多个参数，所以换种方式

```
echo f{1..524288} |xargs touch
```

节点编号

![img](4-文件节点表.assets/clip_image064-164179753255932.jpg)

 上图可见分区的空间大小，以及节点数最大值。sda1的inodes最大值为65536。

超出节点编号就不行了

**echo f{1..65539} |xargs touch**

![img](4-文件节点表.assets/clip_image066-164179753255933.jpg)

所以看到没有设备空间不一定是真的，可能是节点编号满了。

![img](4-文件节点表.assets/clip_image068-164179753255934.jpg)

删除rm *是不行的，可以删除所在文件夹rm -rf /boot/testdir

 或者这么删就行了啊：

```
echo f{1..524288} |xargs rm -rf
```

节点编号和软连接和硬链接密切相关

![image-20220110164258451](4-文件节点表.assets/image-20220110164258451.png) 

 

ext文件系统的架构

![image-20220110164345044](4-文件节点表.assets/image-20220110164345044.png) 

 

直接指针是12个

![image-20220110164500286](4-文件节点表.assets/image-20220110164500286.png) 

 **①数据量低于48K，直接指针就可以搞定。**

![image-20220110164749601](4-文件节点表.assets/image-20220110164749601.png) 

**②超出48K--4M，使用间接指针表示。**

![image-20220110164813549](4-文件节点表.assets/image-20220110164813549.png) 

**③4M-4GB的采用二级指针**

![image-20220110170239283](4-文件节点表.assets/image-20220110170239283.png) 

现在centos7是XFT文件系统和ext的文件系统不一样。

不管什么系统都是类似的机制。

 

对于文件夹来讲他的内容放的是什么

![image-20220110170845135](4-文件节点表.assets/image-20220110170845135.png) 

**文件名是属于文件夹的内容DATA。是放在数据块空间的。**

明白这一点，rm f1本质上是删除他的节点表，指正指向的数据块就没人用了，该空间标记为空闲free状态，但是不会删除数据。如果你新建一个文件可能会覆盖掉的。

此外dir1/下的F1的数据就清了。

![image-20220110171130174](4-文件节点表.assets/image-20220110171130174.png) 



所以删除f1是需要有f1所在文件夹的权限就行了。

硬连接，本身就是同一个文件

![img](4-文件节点表.assets/clip_image084-164179753256042.jpg)

跨分区了**，不同分区**肯定不是一个文件了，所以肯定**不支持**

![img](4-文件节点表.assets/clip_image084-164179753256042.jpg)

硬链接**不能针对文件夹**创建。据说是防止循环现象。

![image-20220110180350667](4-文件节点表.assets/image-20220110180350667.png) 



--------------



 ![image-20220110180016043](4-文件节点表.assets/image-20220110180016043.png) 

![image-20220110180102220](4-文件节点表.assets/image-20220110180102220.png) 

删a1的操作等价上图的示例 





![image-20220110174709900](4-文件节点表.assets/image-20220110174709900.png) 



![image-20220110174724737](4-文件节点表.assets/image-20220110174724737.png) 

